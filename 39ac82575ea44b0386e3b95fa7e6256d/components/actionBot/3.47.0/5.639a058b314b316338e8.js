(window._walkmeABWebpackJP_latest=window._walkmeABWebpackJP_latest||[]).push([[5],{116:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.initSession=t.initSessionFail=t.initSessionSuccess=t.loadBotData=t.resolveBBCodesInBotData=t.getBotDataRequireBBCodesResolve=t.getBotConversationsFail=t.getBotAllConversationsSuccess=t.getBotConversationsSuccess=t.getBotDataFail=t.getBotDataSuccess=void 0;var s,u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=o(n(26)),l=o(n(61)),f=n(54),p=o(n(63)),v=n(32),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),h=n(120),S=n(92),y=n(93),_=n(145),m=t.getBotDataSuccess=function(e){return{type:g.GET_BOT_DATA_SUCCESS,payload:{settings:e,addInitialMessageToChat:1>=arguments.length||void 0===arguments[1]||arguments[1]}}},E=t.getBotDataFail=function(e){return{type:g.GET_BOT_DATA_FAIL,payload:{error:e}}},b=t.getBotConversationsSuccess=function(e){return{type:g.GET_BOT_CONVERSATIONS_SUCCESS,payload:{conversations:e}}},T=t.getBotAllConversationsSuccess=function(e){return{type:g.GET_BOT_ALL_CONVERSATIONS_SUCCESS,payload:{allConversations:e}}},I=t.getBotConversationsFail=function(e){return{type:g.GET_BOT_CONVERSATIONS_FAIL,payload:{error:e}}},w=t.getBotDataRequireBBCodesResolve=function(e){return e?["initialMessages","doneText","noConversationsOneSearchItemFoundText","noMatchedConversationErrorMessages","severalConversationsFoundText"].reduce(function(t,n){return e.hasOwnProperty(n)?c({},t,(o=e[n],(a=n)in(r={})?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)):t;var r,a,o},{}):{}},C=t.resolveBBCodesInBotData=(s=i(a.mark(function e(t){var n,r;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",t);case 2:return n=w(t),e.next=5,(0,v.resolveBBCodes)(JSON.stringify(n));case 5:return r=e.sent,e.prev=6,e.abrupt("return",JSON.parse(r));case 10:return e.prev=10,e.t0=e.catch(6),p.default.error(e.t0,!0),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0,[[6,10]])})),function(){return s.apply(this,arguments)}),A=(t.loadBotData=function(t){var n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],w=3>=arguments.length||void 0===arguments[3]||arguments[3];return n=i(a.mark(function n(i,A){var x,N,O,M,k,D,B,L,R,U,P,G,W,F,V,j,H,Y;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l.default.setNewCancelToken(),(o||s)&&i((0,S.changeBotStatus)(!0)),n.prev=2,n.next=5,r.all([l.default.fetchBotData(t),l.default.getConversations(t)]);case 5:return x=u(n.sent,2),N=x[0],O=x[1],n.next=11,C(N.data);case 11:if(e(N.data,c({},n.sent)),M=A(),!(0,v.hasBotChanged)(M,t)){n.next=16;break}return n.abrupt("return");case 16:if(k=M.settings.conversationId,i(T(D=O.data)),!k){n.next=25;break}return n.next=22,l.default.getConversation(t,k);case 22:D=[n.sent.data];case 25:if(B=(0,d.default)(M,["settings","additionalSettings"],{}),L=B.playMode,R=B.previewEntityType,U=(0,d.default)(N,["data","botCustomStyles"],[]).find(function(e){return e.active}),P=(0,d.default)(U,"css",""),o?(0,v.applyStyles)(P):w&&(0,f.sendWalkMeMessage)({type:g.BOT_SHOW}),i(b(D)),!o||L){n.next=33;break}return n.abrupt("return",i((0,h.tryRestoreDialog)(N.data,D)));case 33:if(G=1===D.length,W=L&&"bot"===R,F=s&&!G||W&&(s||o),V=(0,d.default)(M,["settings","singleConversationPlayed"],!1),i(m(N.data,F)),H=[],!(j=N.data).isWalkMeSearchEnabled||!j.isWalkMeSearchItemsSuggestedInitially){n.next=45;break}return n.next=43,i((0,y.updateWMSearchSuggestions)());case 43:H=(0,d.default)(n.sent,["payload","wmSearchItems"],[]);case 45:!G||H.length||W||V&&!s&&!o?(i((0,y.setInitialSuggestions)(N.data.suggestedConversations,D)),i((0,S.changeBotStatus)(!1))):i((0,_.chooseConversation)(D[0],!0)),n.next=59;break;case 48:if(n.prev=48,n.t0=n.catch(2),!l.default.isCanceled(n.t0)){n.next=52;break}return n.abrupt("return");case 52:(0,f.sendWalkMeMessage)({type:g.INITIAL_DATA_LOAD_FAIL}),Y=(0,d.default)(n.t0,["response","data"],{}),(0,d.default)(n.t0,["response","status"],0),(0,d.default)(n.t0,["config","url"],"").includes("conversations")?i(I(Y)):i(E(Y)),i((0,S.changeBotStatus)(!1)),p.default.error(n.t0,!1);case 59:case"end":return n.stop()}},n,void 0,[[2,48]])})),function(){return n.apply(this,arguments)}},t.initSessionSuccess=function(e,t,n,r){return(0,f.sendWalkMeMessage)({type:g.INIT_SESSION_SUCCESS,payload:{uuid:t}}),{type:g.INIT_SESSION_SUCCESS,payload:{jwt:e,uuid:t,siteConfig:n,globalConfig:r}}}),x=t.initSessionFail=function(e){return(0,f.sendWalkMeMessage)({type:g.INIT_SESSION_FAIL}),{type:g.INIT_SESSION_FAIL,payload:{error:e}}};t.initSession=function(e,t,n,r,o){return s=i(a.mark(function i(s){var u,f,v,g;return a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.default.fetchJWT(c({userGuid:e,walkmeEndUserId:t},n&&{uuid:n}));case 3:v=(u=a.sent.data).uuid,(f=u.jwt)&&v&&s(A(f,v,r,o)),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(0),g=(0,d.default)(a.t0,["response","data"]),s(x(g)),p.default.error(a.t0);case 15:case"end":return a.stop()}},i,void 0,[[0,10]])})),function(){return s.apply(this,arguments)};var s}}).call(this,n(7).assign,n(18).Promise,n(33))},120:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.finishCurrentDialog=t.finishCurrentDialogFail=t.finishCurrentDialogSuccess=t.removeAnswer=t.removeAnswerFail=t.removeAnswerSuccess=t.tryRestoreDialog=t.startOver=t.restoreDialogFail=t.restoreDialogSuccess=t.truncateCurrentDialogData=t.addCurrentDialogData=t.createDialog=t.createDialogSuccess=void 0;var s=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=o(n(26)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),l=o(n(61)),f=o(n(259)),p=n(54),v=o(n(63)),g=n(32),h=n(27),S=n(62),y=n(145),_=n(144),m=n(116),E=n(92),b=n(93),T=n(193),I=t.createDialogSuccess=function(e){return{type:d.CREATE_DIALOG_SUCCESS,payload:{dialog:u({},e,{isRestored:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}}},w=(t.createDialog=function(){return e=i(a.mark(function e(t,n){var r,o,i,s,u,d,p;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=n(),s=(i=r.settings).botId,u=i.envId,d=(0,c.default)(o=r.conversation.picked,h.CLIENT_SIDE_MODE,!1),s){e.next=5;break}return e.abrupt("return");case 5:if(p=void 0,!d){e.next=10;break}p=f.default.createLocalDialog({botId:s,conversationId:o.id,envId:u}),e.next=15;break;case 10:return e.next=12,l.default.createDialog(s,o.id);case 12:p=e.sent.data;case 15:if(!(0,g.hasBotChanged)(n(),s)){e.next=17;break}return e.abrupt("return");case 17:t(I(p)),t((0,y.getFirstConversationNode)()),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),t((0,T.handleError)(e.t0));case 24:case"end":return e.stop()}},e,void 0,[[0,21]])})),function(){return e.apply(this,arguments)};var e},t.addCurrentDialogData=function(e){return{type:d.DIALOG_DATA_ADDED,payload:{data:e}}},t.truncateCurrentDialogData=function(e){return{type:d.DIALOG_TRUNCATE_DATA_SEQUENCE,payload:{dataKey:e}}}),C=t.restoreDialogSuccess=function(e,t,n){return{type:d.RESTORE_DIALOG_SUCCESS,payload:{messages:e,defaultLabels:t,mentionData:n}}},A=t.restoreDialogFail=function(e){return{type:d.RESTORE_DIALOG_FAIL,payload:{error:e}}},x=t.startOver=function(){return e=i(a.mark(function e(t,n){var r,o,i,s,u,c,d,l;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n(),i=(o=r.settings).botId,s=o.separatorNewText,c=(u=r.conversation).picked,d=u.currentNode,(l=r.dialog)&&c&&d&&(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.conversationEnded,{oId:c.id,oName:c.name,pId:l.id,aAppType:d.type,aoId:d.id,aoName:d.name,seekTime:(0,g.getConversationDuration)(r.conversation.conversationStarted),total:r.conversation.conversationLength,reason:2,type:"actionBotConversation",owName:r.settings.name,pInit:{id:i,type:S.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}),e.prev=3,e.next=6,t((0,y.finishConversation)(!1,!1,!1));case 6:t((0,m.loadBotData)(i,!1,!0)),t((0,_.addSeparator)(s||h.DEFAULT_LABELS.separatorNewText,!0)),t((0,E.changeFocusInput)(!0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),v.default.error(e.t0);case 14:case"end":return e.stop()}},e,void 0,[[3,11]])})),function(){return e.apply(this,arguments)};var e},N=(t.tryRestoreDialog=function(e,t){return n=i(a.mark(function n(r,o){var i,u,f,S,T,w,N,O,M,k,D,B,L,R,U,P,G,W,F,V,j,H,Y,z,K,q,Q,X,J,Z,$,ee;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i=(0,c.default)(o(),["settings","conversationId"]),n.next=4,l.default.restoreDialog(e.id,i);case 4:if(f=(u=n.sent).data,S=u.status,T=o(),!(0,g.hasBotChanged)(T,e.id)){n.next=10;break}return n.abrupt("return");case 10:if(204!==S){n.next=26;break}if(w=1===t.length,N=(0,c.default)(T,["settings","additionalSettings"],{}),O=N.playMode&&"bot"===N.previewEntityType,M=[],!e.isWalkMeSearchEnabled||!e.isWalkMeSearchItemsSuggestedInitially){n.next=21;break}return n.next=19,r((0,b.updateWMSearchSuggestions)());case 19:M=(0,c.default)(n.sent,["payload","wmSearchItems"],[]);case 21:return!w||M.length||O?(r((0,m.getBotDataSuccess)(e)),r((0,b.setInitialSuggestions)(e.suggestedConversations,t))):(k=s(t,1),D=k[0],r((0,m.getBotDataSuccess)(e,!1)),r((0,y.chooseConversation)(D))),r((0,E.changeBotStatus)(!1)),B=(0,c.default)(o(),["messages","0","text"],""),(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.chatOpened,{type:"actionBotBot",oId:e.id,oName:e.name,value:B}),n.abrupt("return");case 26:if(L=f.id,R=f.conversationId,P=f.data,!(U=f.sequence)){n.next=71;break}if(G=T.settings.conversations.find(function(e){return e.id===R}),W=U[U.length-1]||{},!G){n.next=71;break}if(F=W.id,V=W.name,j=W.type,H=W.suggestions,Y=W.dataType,z={botId:e.id,conversationId:R,data:{},id:L},K={today:e.separatorTodayText||h.DEFAULT_LABELS.separatorTodayText,yesterday:e.separatorYesterdayText||h.DEFAULT_LABELS.separatorYesterdayText},r((0,y.chooseConversation)(G,!1)),r(I(z,!0)),r(C(U,K,P)),r((0,E.changeBotStatus)(!1)),!U.length){n.next=69;break}if(r((0,y.getConversationNodeSuccess)(W)),q=W.nextConversationNodeId,j&&"message"!==j){n.next=50;break}if(!q){n.next=48;break}r((0,_.getNextConversationNode)(q)),n.next=50;break;case 48:return n.next=50,r((0,y.finishConversation)());case 50:if("question"===j&&(0,g.nodeHasSuggestions)(W)&&(r((0,b.getSuggestionsSuccess)((0,b.getNextSuggestions)(W,H))),Y===h.SALESFORCE_QUESTION_TYPE&&H.length===h.MIN_SUGGESTIONS_CHUNK_SIZE&&r((0,b.getRestSuggestions)(F))),"action"!==j){n.next=67;break}return Q=(0,c.default)(W,["settings","app"]),X=(0,c.default)(W,["settings","id"]),n.next=56,(0,p.sendWalkMeMessage)({type:d.GET_APP_STARTED_FLAG,payload:{app:Q,id:X}});case 56:if(!n.sent){n.next=66;break}if(!q){n.next=62;break}r((0,_.getNextConversationNode)(q)),n.next=64;break;case 62:return n.next=64,r((0,y.finishConversation)());case 64:n.next=67;break;case 66:r((0,y.processConversationNode)(W,L));case 67:n.next=70;break;case 69:r((0,y.getFirstConversationNode)());case 70:(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.chatOpened,{type:"actionBotBot",oId:e.id,oName:e.name,pId:L,aType:"Restored",aAppType:j,aoId:F,aoName:V});case 71:r((0,m.getBotDataSuccess)(e,!1)),n.next=86;break;case 74:if(n.prev=74,n.t0=n.catch(0),!l.default.isCanceled(n.t0)){n.next=78;break}return n.abrupt("return");case 78:r(A(n.t0)),r((0,E.changeBotStatus)(!1)),J=e.conversationUnpublishedText,Z=e.conversationUpdatedText,$=(0,c.default)(n.t0,["response","data","reason"],""),ee=h.DEFAULT_ERROR_MESSAGE,$?("WRONG_DATA"===$.version&&(ee=Z||h.DEFAULT_LABELS.conversationUpdatedText),"NOT_PUBLISHED"!==$.published&&"WRONG_ID"!==$.conversationId||(ee=J||h.DEFAULT_LABELS.conversationUnpublishedText),"NOT_ASSIGNED"===$.conversationId&&(ee=h.DEFAULT_ERROR_MESSAGE)):v.default.error(n.t0),r((0,_.addMessageToChat)(ee)),r(x());case 86:case"end":return n.stop()}},n,void 0,[[0,74]])})),function(){return n.apply(this,arguments)};var n},t.removeAnswerSuccess=function(e,t){return{type:d.REMOVE_ANSWER_SUCCESS,payload:{id:e,nodeId:t}}}),O=t.removeAnswerFail=function(e){return{type:d.REMOVE_ANSWER_FAIL,payload:{error:e}}},M=(t.removeAnswer=function(e,t){return n=i(a.mark(function n(r,o){var i,s,u,d,f;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,i=o(),s=i.settings.botId,d=i.dialog,f=(0,c.default)(u=i.conversation.picked,h.CLIENT_SIDE_MODE,!1),!(s&&u&&d)){n.next=15;break}if(!f){n.next=8;break}r(w(e)),n.next=10;break;case 8:return n.next=10,l.default.removeAnswer(s,u.id,d.id,e);case 10:if(!(0,g.hasBotChanged)(o(),s)){n.next=12;break}return n.abrupt("return");case 12:r((0,b.clearSuggestions)()),r(N(e,t)),r((0,_.getNextConversationNode)(t));case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(0),r(O(n.t0)),v.default.error(n.t0);case 21:case"end":return n.stop()}},n,void 0,[[0,17]])})),function(){return n.apply(this,arguments)};var n},t.finishCurrentDialogSuccess=function(){return{type:d.FINISH_CURRENT_DIALOG_SUCCESS}}),k=t.finishCurrentDialogFail=function(e){return{type:d.FINISH_CURRENT_DIALOG_FAIL,payload:{error:e}}};t.finishCurrentDialog=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e=i(a.mark(function e(n,r){var o,i,s,u,f;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=r(),i=o.settings.botId,u=o.dialog,f=(0,c.default)(s=o.conversation.picked,h.CLIENT_SIDE_MODE,!1),!(i&&s&&u)){e.next=11;break}if(f){e.next=7;break}return e.next=7,l.default.finishDialog(i,s.id,u.id);case 7:if(!(0,g.hasBotChanged)(r(),i)){e.next=9;break}return e.abrupt("return");case 9:n(M()),t&&((0,p.sendWalkMeMessage)({type:d.BOT_CLOSE}),n({type:d.FLUSH_STORE,payload:{isChatNeedDestroy:t}}),f||l.default.cancelAllRequests("Finishing dialog requires closing of chat window"));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),n(k(e.t0)),v.default.error(e.t0);case 17:case"end":return e.stop()}},e,void 0,[[0,13]])})),function(){return e.apply(this,arguments)}}}).call(this,n(7).assign,n(18).Promise,n(33))},144:function(e,t,n){"use strict";(function(e,r,a,o){function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return function(){var t=e.apply(this,arguments);return new a(function(e,n){return function r(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return a.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.initiateWalkMeAction=t.sendMessage=t.processConversationMessage=t.getNextConversationNode=t.addSeparator=t.addIdsToLastMessage=t.addMessageToChat=t.sendMessageFail=void 0;var d=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=i(n(248)),f=i(n(26)),p=i(n(273)),v=n(249),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),h=i(n(61)),S=i(n(259)),y=n(54),_=i(n(63)),m=n(32),E=n(145),b=n(93),T=n(92),I=n(116),w=n(120),C=n(193),A=n(27),x=n(62),N=t.sendMessageFail=function(e){return{type:g.SEND_MESSAGE_FAIL,payload:{error:e}}},O=t.addMessageToChat=function(e){return{type:g.ADD_MESSAGE,payload:{message:{text:e,options:d({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isUserMessage:!1,success:!0,isRichMessage:!1},{timestamp:Date.now()})}}}},M=t.addIdsToLastMessage=function(e,t){return{type:g.ADD_IDS_TO_LAST_MESSAGE,payload:{id:e,nodeId:t}}},k=(t.addSeparator=function(e){return{type:g.ADD_SEPARATOR,payload:{separator:e,isNewSeparator:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}},t.getNextConversationNode=function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return n=c(o.mark(function n(a,i){var s,c,l,_,b,I,x,N,O,M,k,D,B,L,R,U,P,G,W,F,V,j,H,Y,z,K,q,Q,X,J,Z,$,ee,te;return o.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=i(),l=(0,f.default)(c=s.conversation.currentNode,["settings","app"]),_=(0,f.default)(c,["settings","id"]),a((0,E.getConversationNodeSuccess)(null)),a((0,T.changeBotStatus)(!0)),b=i(),N=(x=b.settings).botId,O=x.conversationsNodesMap,M=b.dialog,(I=b.conversation.picked)&&N&&M){n.next=9;break}return n.abrupt("return");case 9:if(k=M.id,D=I.id,B=void 0,!(0,f.default)(I,A.CLIENT_SIDE_MODE,!1)){n.next=28;break}if(L=(0,f.default)(O,[D,"nodes"],[]),R=(0,v.checkNextNode)({conversationNodes:L,nextConversationNodeId:t,flatData:(0,v.getDialogFlatData)(M)}),!(U=R.nextId)){n.next=26;break}return B=(0,f.default)(O,[D,"nodesMap",U]),n.next=20,S.default.processConversationNode({botId:N,conversationId:D,dialog:M,node:B});case 20:G=(P=n.sent).node,(W=P.dialog)&&W.data[U]&&a((0,w.addCurrentDialogData)(u({},U,W.data[U]))),e(G,{data:i().dialog.data||{}}),B=G;case 26:n.next=76;break;case 28:return n.prev=28,n.next=31,h.default.getNextConversationNode(N,D,k,t);case 31:B=n.sent.data,n.next=76;break;case 36:if(n.prev=36,n.t0=n.catch(28),"INSUFFICIENT_DATA"!==(0,f.default)(n.t0,["response","data","reason","bbCodes"])){n.next=75;break}F=(0,f.default)(n.t0,["response","data","data","bbCodes"],[]),V=F.reduce(function(e,t){return d({},e,u({},t,""))},{}),j=!0,H=!1,Y=void 0,n.prev=44,z=Object.keys(V)[Symbol.iterator]();case 46:if(j=(K=z.next()).done){n.next=54;break}return q=K.value,n.next=50,(0,m.resolveBBCodes)(q);case 50:V[q]=n.sent;case 51:j=!0,n.next=46;break;case 54:n.next=60;break;case 56:n.prev=56,n.t1=n.catch(44),H=!0,Y=n.t1;case 60:n.prev=60,n.prev=61,!j&&z.return&&z.return();case 63:if(n.prev=63,!H){n.next=66;break}throw Y;case 66:return n.finish(63);case 67:return n.finish(60);case 68:return n.next=70,h.default.getNextConversationNode(N,D,k,t,{bbCodes:V});case 70:B=n.sent.data,n.next=76;break;case 75:throw n.t0;case 76:if(l&&(0,y.sendWalkMeMessage)({type:g.CLEAN_APP_STARTED_FLAG,payload:{app:l,id:_}}),Q=i(),!(0,m.hasBotChanged)(Q,N)){n.next=80;break}return n.abrupt("return");case 80:if(Q.conversation.picked&&(!Q.dialog||Q.dialog.id===k)){n.next=82;break}return n.abrupt("return");case 82:if(J=(X=B).type,Z=(0,m.getDelayCorrection)(X.aDelay,r),$=(0,f.default)(B,["settings","app"],""),J!==A.CONVERSATION_NODE_TYPES.action||$!==g.START_SMARTWALKTHRU&&$!==g.START_WALKTHRU||a((0,T.changeBotStatus)(!1)),Z<=0){n.next=93;break}return ee=(0,p.default)(Q.messages),n.next=90,(0,m.delay)(Z);case 90:if(te=(0,p.default)(i().messages),ee===te){n.next=93;break}return n.abrupt("return");case 93:a((0,T.changeBotStatus)(!1)),a((0,E.getConversationNodeSuccess)(B)),a((0,E.processConversationNode)(B,k)),n.next=101;break;case 98:n.prev=98,n.t2=n.catch(0),a((0,C.handleError)(n.t2));case 101:case"end":return n.stop()}},n,void 0,[[0,98],[28,36],[44,56,60,68],[61,,63,67]])})),function(){return n.apply(this,arguments)}}),D=function(e,t){try{var n=t(),r=n.settings.liveChat,a=r.enabledGlobal,o=r.suggestionText,i=n.conversation.currentNode,u=n.analytics.retriesAnswerQuestion,c=n.suggestions.items,d=(0,f.default)(i,"liveChatEnabled",!1),l=(0,f.default)(i,"failsBeforeLiveChatTriggered",3);if(a&&d&&u>=l)c&&c.length&&c[0].id===A.LIVE_CHAT_SUGGESTION_ID||e((0,b.getSuggestionsSuccess)([{id:A.LIVE_CHAT_SUGGESTION_ID,type:A.SUGGESTION_TYPES.liveChat,displayName:o||A.DEFAULT_LABELS.liveChatSuggestionText}].concat(s(c))))}catch(e){_.default.error(e)}},B=t.processConversationMessage=function(e){var t,n=e.text,r=e.picked,a=e.dialog,i=e.currentNode,s=e.botId;return t=c(o.mark(function e(t,u){var c,d,l,p,_,N,B,L,R,U,P,G,W,F,V,j,H,Y,z,K,q,Q,X,J,Z,$,ee,te,ne,re,ae;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=void 0,d=a,e.prev=2,t((0,T.changeBotStatus)(!0)),l=r.id,p=r.name,N=void 0!==(_=r.clientSideMode)&&_,B=a.id,L=i.id,R=i.name,U=i.type,P=i.dataType,G=i.suggestions,W=u(),F=W.settings.conversationsNodesMap,"connection_salesforce"===P&&G&&("true"===n&&G.includes(!0)&&(n=!0),"false"===n&&G.includes(!1)&&(n=!1),G.includes(Number(n))&&(n=Number(n))),V={botId:s,conversationId:l,dialogId:B,text:n,nodeId:L},j=new Date,H=0,Y=!1,z=A.DEFAULT_ERROR_MESSAGE,K="extraction",q=null,e.prev=16,Q=null,!N){e.next=24;break}return e.next=21,S.default.sendUserMessage(V,(0,f.default)(F,[l,"nodesMap",L],null),d);case 21:Q=e.sent,e.next=27;break;case 24:return e.next=26,h.default.sendUserMessage(V);case 26:Q=e.sent;case 27:c=X=Q.data,H=X.id,Y=X.success,z=X.errorMessage,K=X.errorType,q=X.nextConversationNodeId,e.next=44;break;case 36:if(e.prev=36,e.t0=e.catch(16),J=(0,f.default)(e.t0,["response","data"],{}),$=J.message,!(Z=J.reason)||"WRONG_DATA"!==Z.text||"connection_salesforce"!==P){e.next=43;break}z=$,e.next=44;break;case 43:throw e.t0;case 44:if(ee=u(),!(0,m.hasBotChanged)(ee,s)){e.next=47;break}return e.abrupt("return");case 47:if(t(M(H,L)),t({type:g.ANALYTICS_ANSWER_QUESTION_TRY}),(0,y.sendAnalyticsEvent)(A.ANALYTICS_EVENTS.conversationsQuestionAnswered,{type:"actionBotNode",oId:L,oName:R,owId:r.id,owType:"actionBotConversation",owName:r.name,pId:B,aAppType:P,retries:ee.analytics.retriesAnswerQuestion,value:n,reason:Y?3:"extraction"===K?2:1},{skipPInit:!0}),!Y){e.next=65;break}if(N&&(te=S.default.getMessageData(ee,c,{conversationId:l,nodeId:L}))&&(t((0,w.addCurrentDialogData)(te)),d=u().dialog),N&&(ne=(0,f.default)(F,[l,"nodes"],[]),re=(0,v.checkNextNode)({conversationNodes:ne,nextConversationNodeId:q,flatData:(0,v.getDialogFlatData)(d)}),q=re.nextId),!q){e.next=59;break}t(k(q,j)),e.next=63;break;case 59:return(0,y.sendAnalyticsEvent)(A.ANALYTICS_EVENTS.conversationEnded,{oId:l,oName:p,pId:B,aAppType:U,aoId:L,aoName:R,seekTime:(0,m.getConversationDuration)(ee.conversation.conversationStarted),total:ee.conversation.conversationLength,reason:1,type:"actionBotConversation",owName:ee.settings.name,pInit:{id:s,type:x.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}),e.next=62,t((0,E.finishConversation)());case 62:t((0,I.loadBotData)(s));case 63:e.next=74;break;case 65:if((ae=(0,m.getDelayCorrection)(i.aDelay,j))<=0){e.next=70;break}return e.next=70,(0,m.delay)(ae);case 70:t((0,T.changeBotStatus)(!1)),t(O(z,{isUserMessage:!1,success:!1})),t((0,b.restoreCurrentNodeSuggestions)()),t(D);case 74:e.next=79;break;case 76:e.prev=76,e.t1=e.catch(2),t((0,C.handleError)(e.t1));case 79:case"end":return e.stop()}},e,void 0,[[2,76],[16,36]])})),function(){return t.apply(this,arguments)}},L=function(e,t){try{var n=t(),r=n.settings.liveChat,a=n.suggestions.items;if(r.enabledGlobal&&r.enabled&&n.analytics.retriesConversationSearch>=r.failsBeforeTrigger&&!r.temporaryDisabled)a&&a.length&&a[0].id===A.LIVE_CHAT_SUGGESTION_ID||e((0,b.getSuggestionsSuccess)([{id:A.LIVE_CHAT_SUGGESTION_ID,type:A.SUGGESTION_TYPES.liveChat,displayName:r.suggestionText||A.DEFAULT_LABELS.liveChatSuggestionText}].concat(s(a))))}catch(e){_.default.error(e)}},R=function(e,t){try{var n=t(),r=n.settings,a=r.fallbackConversations,o=r.conversations,i=n.suggestions.items;if(n.analytics.retriesConversationSearch>=r.failsBeforeFallbackSuggested&&a.length){var u=i.find(function(e){return e.id===A.LIVE_CHAT_SUGGESTION_ID}),c=i.filter(function(e){var t=e.id;return![].concat(s(a),[A.LIVE_CHAT_SUGGESTION_ID]).includes(t)}),d=a.map(function(e){var t=o.find(function(t){return t.id===e});return t&&{id:e,displayName:t.displayName,type:A.SUGGESTION_TYPES.conversation}}).filter(Boolean),l=[].concat(s(u?[u]:[]),s(d),s(c));e((0,b.getSuggestionsSuccess)(l))}}catch(e){_.default.error(e)}};t.sendMessage=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,f,p,v,S,_,I,w,x,M,k,D,U,P,G,W,F,V,j,H,Y;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a={isUserMessage:!0,success:!0},n(O("string"==typeof e?e:String(e.displayName),a)),n((0,b.clearSuggestions)()),i=r(),c=(s=i.conversation).currentNode,p=(f=i.settings).botId,v=f.conversationId,S=f.name,_=f.noMatchedConversationErrorMessages,I=f.noConversationsOneSearchItemFoundText,w=f.severalConversationsFoundText,x=f.conversations,M=f.isWalkMeSearchEnabled,k=f.isWalkMeSearchItemsSuggestedInitially,D=i.dialog,U=i.suggestions.wmSearchItems,!((u=s.picked)&&D&&c&&p)){t.next=11;break}P=void 0,P=(0,m.isValidMessageValue)(e.extractValue)?e.extractValue:(0,m.isValidMessageValue)(e.displayName)?e.displayName:e,n(B({text:P,picked:u,dialog:D,currentNode:c,botId:p})),t.next=47;break;case 11:if(p){t.next=13;break}return t.abrupt("return");case 13:if(G=[],p!==A.DEFAULT_BOT_ID){t.next=21;break}return W=String(e).trim().toLowerCase(),t.next=18,(0,m.delay)(500);case 18:G=x.filter(function(e){return e.keywords.some(function(e){return W.includes(e.toLowerCase())})}),t.next=25;break;case 21:return t.next=23,h.default.getConversations(p,e);case 23:F=t.sent,G=v?F.data.filter(function(e){return e.id===v}):F.data;case 25:if(V=r(),!(0,m.hasBotChanged)(V,p)){t.next=28;break}return t.abrupt("return");case 28:if(G=G.map(function(e){return d({},e,{type:A.SUGGESTION_TYPES.conversation})}),j=M?U:[],n({type:g.ANALYTICS_CONVERSATION_SEARCH_TRY,payload:{searchTerm:e}}),!G.length&&!j.length){t.next=37;break}H=1===G.length,(0,y.sendAnalyticsEvent)(A.ANALYTICS_EVENTS.conversationsSearch,{type:"actionBotBot",oId:p,oName:S,value:e,seekTime:V.analytics.retriesConversationSearch,total:G.length,reason:1}),H&&0===j.length?n((0,E.chooseConversation)(G[0],!0)):(n((0,b.getSuggestionsSuccess)(G)),n(O(1===j.length&&0===G.length?I||A.DEFAULT_LABELS.noConversationsOneSearchItemFoundText:w||A.DEFAULT_LABELS.severalConversationsFoundText)),n((0,T.changeFocusInput)(!0))),t.next=46;break;case 37:if(Y=(0,l.default)(_),(0,y.sendAnalyticsEvent)(A.ANALYTICS_EVENTS.conversationsSearch,{type:"actionBotBot",oId:p,oName:S,value:e,seekTime:V.analytics.retriesConversationSearch,total:G.length,reason:2}),n(O(Y,{isUserMessage:!1,success:!1})),n((0,b.setInitialSuggestions)()),!M||!k){t.next=44;break}return t.next=44,n((0,b.updateWMSearchSuggestions)());case 44:n(L),n(R);case 46:n((0,T.changeBotStatus)(!1));case 47:t.next=53;break;case 49:t.prev=49,t.t0=t.catch(0),n(N(t.t0)),n((0,C.handleError)(t.t0));case 53:case"end":return t.stop()}},t,void 0,[[0,49]])})),function(){return t.apply(this,arguments)};var t},t.initiateWalkMeAction=function(e,t){return n=c(o.mark(function n(r,a){var i,s;return o.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=a(),s={type:g.WALK_ME_ACTION,payload:{settings:{id:e,app:t},answers:{},chatHistory:[],options:{conversationId:null,botId:i.settings.botId,dialogId:null}}},(0,y.sendWalkMeMessage)({type:g.BOT_HIDE}),(0,y.sendWalkMeMessage)(s);case 4:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n}}).call(this,n(7).assign,n(31).from,n(18).Promise,n(33))},145:function(e,t,n){"use strict";(function(e,r,a,o,i){function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstConversationNode=t.processConversationNode=t.openLiveChat=t.finishConversation=t.getConversationNodeSuccess=t.chooseConversation=void 0;var d,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=s(n(26)),g=s(n(61)),h=n(54),S=s(n(63)),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),_=n(144),m=n(193),E=n(120),b=n(116),T=n(92),I=n(93),w=n(32),C=n(27),A=n(62),x=n(334),N=function(e){return e.reduce(function(e,t){var n=t.text,r=t.options;if((0,v.default)(r,"isSeparator"))return e;var o=n;return(0,v.default)(r,"isRichMessage")&&(o=(0,w.stripHTMLTags)(n)),[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}(e),[{text:o,options:{isUserMessage:r.isUserMessage,timestamp:r.timestamp}}])},[])},O=t.chooseConversation=function(e){var t=1>=arguments.length||void 0===arguments[1]||arguments[1];return function(n,r){var a=r();n({type:y.CHOOSE_CONVERSATION_SUCCESS,payload:{conversation:e,byKeyword:a.analytics.searchTerm}}),t&&n((0,E.createDialog)())}},M=t.getConversationNodeSuccess=function(e){return{type:y.GET_CONVERSATION_NODE_SUCCESS,payload:{node:e,incrementCounter:Boolean(e)}}},k=t.finishConversation=function(){var e,t=0>=arguments.length||void 0===arguments[0]||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=2>=arguments.length||void 0===arguments[2]||arguments[2];return e=c(o.mark(function e(a,i){var s,u,c,d;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i(),c=(u=s.settings).doneText,d=u.separatorCompletedText,a((0,T.changeBotStatus)(!1)),t&&(a((0,_.addSeparator)(d||C.DEFAULT_LABELS.separatorCompletedText)),a((0,_.addMessageToChat)(c||C.DEFAULT_LABELS.doneText))),e.next=5,a((0,E.finishCurrentDialog)(n));case 5:a(r?(0,I.setInitialSuggestions)():(0,I.clearSuggestions)()),a({type:y.FINISH_CONVERSATION});case 7:case"end":return e.stop()}},e,void 0)})),function(){return e.apply(this,arguments)}},D=function(e,t){var n=e.conversation,r=n.picked,a=n.conversationLength,o=e.settings,i=o.botId,s=o.name;return{oId:r.id,oName:r.name,pId:e.dialog.id,aAppType:t.type,aoId:t.id,aoName:t.name,seekTime:(0,w.getConversationDuration)(n.conversationStarted),total:a,type:"actionBotConversation",owName:s,pInit:{id:i,type:A.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}},B=t.openLiveChat=function(){return e=c(o.mark(function e(t,n){var r,a,i,s,u,c,d,l,f,p,g;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(),i=(a=r.settings).botId,s=a.liveChat.enabledGlobal,u=r.conversation.picked,c=r.dialog,d=r.messages,l=r.suggestions,e.prev=1,s){e.next=4;break}throw new Error("LIVE_CHAT isn't enabled globally but tried to initiate session");case 4:return f=(0,v.default)(u,"id"),p=(0,v.default)(c,"id"),g={app:y.LIVE_CHAT},e.next=9,(0,h.sendWalkMeMessage)({type:y.WALK_ME_ACTION,payload:{settings:g,options:{conversationId:f,botId:i,dialogId:p},chatHistory:N(d)}});case 9:e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(1),t({type:y.DISABLE_LIVE_CHAT}),t((0,I.getSuggestionsSuccess)(l.items.filter(function(e){return e.id!==C.LIVE_CHAT_SUGGESTION_ID}))),new Error("Action type LIVE_CHAT failed.");case 16:case"end":return e.stop()}},e,void 0,[[1,11]])})),function(){return e.apply(this,arguments)};var e},L=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,i=e.nextConversationNodeId,s=e.textSettings,u=e.data,c=e.text,d=r(),l=d.settings.botId,f=s?(0,w.convertToPureText)(s,u):c,n((0,T.changeBotStatus)(!0)),t.next=7,(0,w.resolveBBCodes)(f);case 7:if(n((0,_.addMessageToChat)(t.sent,{id:a,isUserMessage:!1,success:!0,isRichMessage:!0})),i){t.next=16;break}return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},D(d,e),{reason:1})),t.next=13,n(k());case 13:n((0,b.loadBotData)(l,!1,!1,!1)),t.next=17;break;case 16:n((0,_.getNextConversationNode)(i));case 17:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},R=function(e){return t=c(o.mark(function t(n){var r,a,i,s,u,c,d;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,i=e.text,s=e.dataType,u=e.suggestions,c=(a=e.textSettings)?(0,w.convertToPureText)(a,e.data):i,t.next=4,(0,w.resolveBBCodes)(c);case 4:n((0,_.addMessageToChat)(t.sent,{id:r,isUserMessage:!1,success:!0,isRichMessage:!0})),d=(0,I.getNextSuggestions)(e,u),n((0,T.changeBotStatus)(!1)),n((0,I.getSuggestionsSuccess)(d)),s===C.SALESFORCE_QUESTION_TYPE&&u.length===C.MIN_SUGGESTIONS_CHUNK_SIZE&&n((0,I.getRestSuggestions)(r)),n((0,T.changeFocusInput)(!0));case 11:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},U=(u(d={},y.WEBHOOK,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,v,g,S,y,m,E,b;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.id,i=e.name,u=e.type,c=e.nextConversationNodeId,d=e.success,l=e.isConversationEnd,f=(s=e.settings).mandatory,v=s.errorMessage,g=r(),S=g.settings.additionalSettings,(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:a,oName:i,owId:(y=g.conversation.picked).id,owType:"actionBotConversation",owName:y.name,pId:g.dialog.id,aType:"webhooksDestination",aAppType:u,aoId:s.id,reason:(m=!f||f&&d)?1:2},{skipPInit:!0}),E=p({},D(g,e),{aType:"webhooksDestination",oIsWithAction:!0,wId:s.id}),!m){t.next=22;break}if(!l){t.next=13;break}return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},E,{reason:1})),t.abrupt("return",n(k(!0,!S.playMode)));case 13:if(l||!c){t.next=17;break}n((0,_.getNextConversationNode)(c)),t.next=20;break;case 17:return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},E,{reason:4})),n((0,_.addMessageToChat)(C.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(k()));case 20:t.next=30;break;case 22:if((0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},E,{reason:4})),b=C.DEFAULT_ERROR_MESSAGE,!v){t.next=28;break}return t.next=27,(0,w.resolveBBCodes)(v);case 27:b=t.sent;case 28:return n((0,_.addMessageToChat)(b,{isUserMessage:!1,success:!1})),t.abrupt("return",n(k()));case 30:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}),u(d,y.LIVE_CHAT,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,v,g;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,i=e.name,s=e.settings,u=e.type,c=e.nextConversationNodeId,d=e.isConversationEnd,l=r(),f=l.settings.additionalSettings,(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:a,oName:i,owId:(v=l.conversation.picked).id,owType:"actionBotConversation",owName:v.name,pId:l.dialog.id,aType:"liveChat",aAppType:u},{skipPInit:!0}),g=p({},D(l,e),{aType:"liveChat",oIsWithAction:!0,wId:s.id}),t.prev=5,t.next=8,n(B());case 8:if(!d){t.next=13;break}return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},g,{reason:1})),t.abrupt("return",n(k(!0,!f.playMode)));case 13:if(d||!c){t.next=17;break}n((0,_.getNextConversationNode)(c)),t.next=20;break;case 17:return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},g,{reason:4})),n((0,_.addMessageToChat)(C.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(k()));case 20:t.next=29;break;case 22:return t.prev=22,t.t0=t.catch(5),S.default.error(t.t0,!0),n((0,_.addMessageToChat)(C.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.next=28,n(k());case 28:(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},g,{reason:4}));case 29:case"end":return t.stop()}},t,void 0,[[5,22]])})),function(){return t.apply(this,arguments)};var t}),u(d,y.CONVERSATION,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,v,g,m;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.type,s=e.id,u=(a=e.settings).id,c=r(),d=c.conversation.picked,l=c.dialog,f="actionBotConversation",v=c.settings.allConversations.find(function(e){return e.id===u}),(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:s,oName:name,owId:d.id,owType:"actionBotConversation",owName:d.name,pId:l.id,aType:f,aAppType:i,aoId:a.id},{skipPInit:!0}),g=p({},D(c,e),{aType:f,oIsWithAction:!0,wId:a.id}),!v){t.next=13;break}return(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},g,{reason:1})),t.next=12,n(k(!1,!1,!1));case 12:return t.abrupt("return",n(O(v)));case 13:return(m=c.settings.additionalSettings).playMode&&"conversation"===m.previewEntityType&&(0,h.sendWalkMeMessage)({type:y.WALK_ME_ACTION,payload:{settings:a}}),S.default.error(new Error("Bot tried to launch Conversation which is not present in its conversation list."),!0),(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},g,{reason:4})),n((0,_.addMessageToChat)(C.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(k()));case 19:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}),d),P=function(t){return n=c(o.mark(function n(r,a){var s,c,d,m,E,I,w,A,O,M,B,L,R,P,G,W,F,V,j,H,Y,z,K,q,Q,X,J,Z,$,ee,te;return o.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=t.id,c=t.name,d=t.type,m=t.actionType,E=t.settings,I=t.dataMapping,w=t.isConversationEnd,A=t.nextConversationNodeId,O=a(),B=(M=O.settings).botId,L=M.additionalSettings,R=M.globalConfig,P=O.conversation.picked,G=O.dialog,W=O.messages,F=(0,v.default)(E,"app",""),V=(0,v.default)(P,C.CLIENT_SIDE_MODE,!1),j=[y.START_WALKTHRU,y.START_SMARTWALKTHRU,y.SMARTWALKTHRU].includes(F),H=j&&!t.hasOwnProperty("isConversationEnd")&&null===A,(Y=!L.playMode&&![y.WEBHOOK,y.CONVERSATION,y.LIVE_CHAT].includes(F)&&(0,v.default)(R,"closeOnAction",!0)&&(w||H))&&(0,h.sendWalkMeMessage)({type:y.BOT_HIDE}),!B){n.next=54;break}if("WalkMe"!==m){n.next=53;break}if(z=P.id,K=G.id,q=N(W),Q={},!x.ACTIONS_REQUIRE_DATA_SAVE.includes(F)){n.next=31;break}if(X={},!V){n.next=23;break}X=G.data,n.next=27;break;case 23:return n.next=25,g.default.getDialog(B,z,K);case 25:X=n.sent.data.data;case 27:J=i(X).reduce(function(e,t){var n=f(t,2),r=n[0],a=n[1];return a&&a.type===C.MENTION_DATA_TYPES.variable?"object"===l(a.value)?p({},e,i(a.value).reduce(function(e,t){var n=f(t,2);return p({},e,u({},n[0],{value:n[1],nodeId:Number(r)}))},{})):e:p({},e,u({},r,p({},a,{nodeId:Number(r)})))},{}),Z=Object.keys(I),$=Z.reduce(function(e,t){var n=I[t],r=J[t];return n&&r?p({},e,u({},n,r)):e},{}),e(Q,$);case 31:if(!U[F]){n.next=34;break}return r((0,T.changeBotStatus)(!0)),n.abrupt("return",r(U[F](t)));case 34:if(!w&&!H){n.next=40;break}return n.next=37,r(k(!0,Y));case 37:r((0,b.loadBotData)(B,!1,!1,!1)),(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:s,oName:c,owId:P.id,owType:"actionBotConversation",owName:P.name,pId:G.id,aType:"bizFlow",aAppType:d,aoId:E.id},{skipPInit:!0}),(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationEnded,p({},D(O,t),{aType:"bizFlow",pId:K,oIsWithAction:!0,wId:E.id,reason:1}));case 40:if(ee=(0,v.default)(E,"waitForActionEnds",!1),te={type:y.WALK_ME_ACTION,payload:{settings:E,answers:Q,chatHistory:q,options:{conversationId:z,botId:B,dialogId:K}}},!ee||L.playMode){n.next=49;break}return r((0,T.changeBotStatus)(!0)),n.next=46,(0,h.sendWalkMeMessage)(te);case 46:r((0,T.changeBotStatus)(!1)),n.next=50;break;case 49:(0,h.sendWalkMeMessage)(te);case 50:A&&r((0,_.getNextConversationNode)(A)),n.next=54;break;case 53:throw new Error("Unknown action type: "+m);case 54:n.next=59;break;case 56:n.prev=56,n.t0=n.catch(0),S.default.error(n.t0);case 59:case"end":return n.stop()}},n,void 0,[[0,56]])})),function(){return n.apply(this,arguments)};var n},G=t.processConversationNode=function(e,t){return n=c(o.mark(function n(r,a){var i,s,u,c,d,l,f;return o.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.id,s=e.type,u=e.name,c=e.settings,d=a(),l=d.conversation.picked,(!(f=d.dialog)||f.id===t)&&l&&f){n.next=5;break}return n.abrupt("return");case 5:(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationsNodeServed,p({type:"actionBotNode",oId:i,oName:u,owId:l.id,owType:"actionBotConversation",owName:l.name,pId:f.id,aAppType:s},s===C.CONVERSATION_NODE_TYPES.action&&{aoId:c.id}),{skipPInit:!0}),n.t0=s,n.next=n.t0===C.CONVERSATION_NODE_TYPES.message?9:n.t0===C.CONVERSATION_NODE_TYPES.question?10:n.t0===C.CONVERSATION_NODE_TYPES.action?11:12;break;case 9:return n.abrupt("return",r(L(e)));case 10:return n.abrupt("return",r(R(e)));case 11:return n.abrupt("return",r(P(e)));case 12:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n};t.getFirstConversationNode=function(){return e=c(o.mark(function e(t,n){var r,a,i,s,u,c,d,l,f,S,y,_,E,b,I,x;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t((0,T.changeBotStatus)(!0)),r=n(),s=(i=r.settings).botId,u=i.name,c=i.conversationsNodesMap,d=r.dialog,f=(a=r.conversation).byKeyword,(l=a.picked)&&s&&d){e.next=6;break}return e.abrupt("return");case 6:if(S=d.id,y=l.id,_=new Date,E=(0,v.default)(l,C.CLIENT_SIDE_MODE,!1),b=void 0,!E){e.next=16;break}I=(0,v.default)(c,[y,"entryPointId"]),b=(0,v.default)(c,[y,"nodesMap",I]),e.next=21;break;case 16:return e.next=18,g.default.getFirstConversationNode(s,y,S);case 18:b=e.sent.data;case 21:if(!(0,w.hasBotChanged)(n(),s)){e.next=23;break}return e.abrupt("return");case 23:if(!b){e.next=35;break}if((x=(0,w.getDelayCorrection)(b.aDelay,_))<=0){e.next=29;break}return e.next=29,(0,w.delay)(x);case 29:if(n().dialog===d){e.next=32;break}return e.abrupt("return");case 32:(0,h.sendAnalyticsEvent)(C.ANALYTICS_EVENTS.conversationStarted,p({type:"actionBotConversation",oId:l.id,oName:l.name,owName:u,pId:S,pInit:{id:s,type:A.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}},f?{value:f}:null)),t(M(b)),t(G(b,S));case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(0),t((0,m.handleError)(e.t0));case 40:case"end":return e.stop()}},e,void 0,[[0,37]])})),function(){return e.apply(this,arguments)};var e}}).call(this,n(7).assign,n(18).Promise,n(31).from,n(33),n(7).entries)},193:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleError=void 0;var a=r(n(26)),o=n(144),i=n(92),s=n(93),u=n(120),c=n(54),d=r(n(63)),l=n(32),f=n(27),p=n(62),v=r(n(61));t.handleError=function(e){return function(t,n){if(!v.default.isCanceled(e)){t((0,i.changeBotStatus)(!1));var r=n().settings,g=r.conversationUnpublishedText,h=r.conversationUpdatedText,S=(0,a.default)(e,["response","data","reason"],""),y=f.DEFAULT_ERROR_MESSAGE;S?("WRONG_DATA"===S.version&&(y=h||f.DEFAULT_LABELS.conversationUpdatedText),"NOT_PUBLISHED"!==S.published&&"WRONG_ID"!==S.conversationId||(y=g||f.DEFAULT_LABELS.conversationUnpublishedText),"NOT_ASSIGNED"===S.conversationId&&(y=f.DEFAULT_ERROR_MESSAGE)):d.default.error(e),t((0,u.finishCurrentDialog)()),t((0,s.clearSuggestions)()),t((0,o.addMessageToChat)(y));var _=n(),m=_.settings,E=m.botId,b=m.name,T=_.conversation,I=T.picked,w=T.currentNode,C=T.conversationLength,A=_.dialog;A&&I&&w&&(0,c.sendAnalyticsEvent)(f.ANALYTICS_EVENTS.conversationEnded,{oId:I.id,oName:I.name,pId:A.id,aAppType:w.type,aoId:w.id,aoName:w.name,seekTime:(0,l.getConversationDuration)(T.conversationStarted),total:C,reason:3,type:"actionBotConversation",owName:b,pInit:{id:E,type:p.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}})}}}},198:function(e,t,n){"use strict";(function(e,r){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});"function"==typeof Symbol&&Symbol;var o=n(150),i=a(n(386)),s=a(n(387)),u=a(n(486)),c=a(n(63)),d=(0,o.createStore)(s.default,(0,o.compose)((0,o.applyMiddleware)(i.default,function(){return function(t){return n=r.mark(function e(n){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t(n));case 4:e.prev=4,e.t0=e.catch(0),c.default.error(e.t0);case 7:case"end":return e.stop()}},e,void 0,[[0,4]])}),a=function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})},function(){return a.apply(this,arguments)};var n,a}})));(0,u.default)(d),t.default=d}).call(this,n(18).Promise,n(33))},259:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=o(n(26)),d=n(249),l=o(n(395)),f=o(n(250)),p=o(n(474)),v=o(n(475)),g=o(n(476)),h=o(n(61)),S=n(25),y=n(27);f.default.add_operation("Date",Date);var _,m,E={date:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).utcOffset;if(!(e instanceof Date)&&Number.isNaN(Date.parse(e)))return e;if((0,p.default)(t))throw new Error("utcOffset is mandatory");if("number"!=typeof t)throw new Error("utcOffset should be a number");return(0,g.default)(new Date(e),t).toString()}},b=function(e,t){return(0,(0,l.default)()(t.dataType).execute)(e,t)},T=(_=i(a.mark(function t(n,r,o){var i,c,l,g,S,_,m,T,I,w,C,A,x;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r?JSON.parse(JSON.stringify(r)):r,c=i.nextConversationNodeId,S=n.botId,_=n.conversationId,m={success:!0,text:l=n.text,id:g=n.nodeId,dialogId:o.id,errorMessage:null,dataType:i.dataType,createdAt:(new Date).toISOString()},t.prev=4,T=(0,d.getDialogFlatData)(o),!(i=(0,d.replaceSuggestionsKeys)(i,T)).isSuggestionsOnly||i.dataType===y.SALESFORCE_QUESTION_TYPE||i.suggestions.includes(l)){t.next=9;break}throw new Error("An answer should be only from suggestions",{errorData:{code:"BAD_REQUEST",message:"An answer should be only from suggestions",reason:{text:"WRONG_DATA"}}});case 9:if(I=void 0,i.dataType!==y.SALESFORCE_QUESTION_TYPE){t.next=19;break}return t.next=13,h.default.postSalesforceMessage({botId:S,conversationId:_,nodeId:g,text:l,dialog:o});case 13:e(m,{data:I=t.sent.data.data}),t.next=23;break;case 19:I=b(l,i),w={utcOffset:(new Date).getTimezoneOffset()},E.hasOwnProperty(i.dataType)&&(I=E[i.dataType](I,w)),e(m,{data:I});case 23:C=(0,v.default)(o.data,s({},i.id,{value:I,settings:i.settings,type:i.dataType})),T=(0,d.getDialogFlatData)(u({},o,{data:C})),(0,p.default)(I)?(c=null,m.success=!1,m.errorMessage=i.errorMessage,m.errorType="extraction"):(x=(void 0===(A=i.validations)?[]:A).find(function(e){return!f.default.apply(e.condition.logic,T)}))&&(c=null,m.success=!1,m.errorMessage=x.error,m.errorType="validation"),m.success&&e(m,{nextConversationNodeId:c,success:!0,id:g}),t.next=32;break;case 29:return t.prev=29,t.t0=t.catch(4),t.abrupt("return",{data:e(m,{nextConversationNodeId:c,success:!1,id:g,errorMessage:t.t0.message})});case 32:return t.abrupt("return",{data:m});case 33:case"end":return t.stop()}},t,void 0,[[4,29]])})),function(){return _.apply(this,arguments)}),I=(m=i(a.mark(function t(n){var r,o,i,s,u,c,d,l,f;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.botId,i=n.conversationId,s=n.dialog,u={node:r=n.node,dialog:null},r){t.next=4;break}return t.abrupt("return",u);case 4:if(d=r.settings,l=r.id,(c=r.type)!==y.CONVERSATION_NODE_TYPES.question||r.dataType!==y.SALESFORCE_QUESTION_TYPE){t.next=16;break}return t.prev=6,t.next=9,h.default.postNode({botId:o,conversationId:i,nodeId:l,dialog:s});case 9:e(u,{node:t.sent.data.node}),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(6);case 16:if(c!==y.CONVERSATION_NODE_TYPES.action||d.app!==S.WEBHOOK){t.next=27;break}return t.prev=17,t.next=20,h.default.postNode({botId:o,conversationId:i,nodeId:l,dialog:s});case 20:e(u,{node:(f=t.sent.data).node,dialog:f.dialog}),t.next=27;break;case 25:t.prev=25,t.t1=t.catch(17);case 27:return t.abrupt("return",u);case 28:case"end":return t.stop()}},t,void 0,[[6,14],[17,25]])})),function(){return m.apply(this,arguments)});t.default={createLocalDialog:function(e){var t=e.botId,n=e.conversationId,r=e.envId;return{id:(new Date).getTime(),dataKeysSequence:[],data:{},botId:t,conversationId:n,envId:r}},getMessageData:function(e,t,n){var r=n.nodeId,a=(0,c.default)(e,["settings","conversationsNodesMap",n.conversationId,"nodesMap",r]);return a?s({},r,{type:a.dataType,value:t.data,settings:a.settings||{}}):null},sendUserMessage:T,processConversationNode:I}}).call(this,n(7).assign,n(18).Promise,n(33))},32:function(e,t,n){"use strict";(function(e,r,a,o,i,s){function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function c(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=Math.abs(t.getTime()-e.getTime());return Math.floor(n/864e5)}function v(e){if(e>3&&21>e)return e+"th";switch(e%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd";default:return e+"th"}}function g(e,t){var n=p(e,new Date);return 0===n?t.today:1===n?t.yesterday:e.toLocaleString("en-us",{month:"short"})+" "+v(e.getDate())}function h(e){function t(e,t){var r=(0,T.default)(e,["data","mention","id"],0),a=(0,T.default)(n,r,null);if(!a)return null;var o=(0,T.default)(a,["settings","format"],N.DATE_FORMATS.littleEndian),i=(0,x.default)(a,N.DATE_FORMATS[o]+" HH:mm"),s="boolean"==typeof i?String(i):i;return k(s)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?"<"+t+">"+e+"</"+t+">":e}(s,function(e){var t=/^<(\w+)>.*<\/(\w+)>/.exec(e);if(t){var n=_(t,3),r=n[1],a=n[2];return r&&a&&r===a?r:""}return""}(t)):t}var n=o((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})||{}).reduce(function(e,t){var n=_(t,2),r=n[0],a=n[1];return N.QUESTION_DATA_TYPES.hasOwnProperty(a.type)?y({},e,f({},r,a)):a.type===N.MENTION_DATA_TYPES.variable&&"object"===S(a.value)?y({},e,o(a.value).reduce(function(e,t){var n=_(t,2);return y({},e,f({},n[0],{type:N.MENTION_DATA_TYPES.variable,value:n[1]}))},{})):e},{}),r=y({},e,{blocks:e.blocks.map(function(e){return y({},e,{text:(0,I.default)(e.text)})})});return(0,w.default)(r,void 0,void 0,function(e,n){switch(e.type){case"LINK":return'<a href="'+e.data.url+'" target="_blank" rel="noopener noreferrer">'+n+"</a>";case"mention":return k(t(e,n))?String(t(e,n)):Object.create({toString:function(){return""},valueOf:function(){return""}});default:return n}})}Object.defineProperty(t,"__esModule",{value:!0}),t.nodeHasSuggestions=t.suggestionsSorter=t.getInitialWMSearchResult=t.resolveBBCodes=t.getWMSearchResult=t.stripHTMLTags=t.noop=t.toHyphenCase=t.isValidMessageValue=t.safeDomElementRemove=void 0;var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.createReducer=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments[1],a=t[r.type];return a?a(n,r.payload):n}},t.rearrangeStyles=function(){var e=document.getElementById(N.STYLE_TAG_ID);e&&(M(e),document.head&&document.head.append(e))},t.applyStyles=function(e){var t,n;(function(){var e=document.getElementById(N.LINK_TAG_ID);e&&M(e);var t=document.getElementById(N.STYLE_TAG_ID);t&&(t.textContent="")})(),e?C.test(e)?(t=e,(n=document.createElement("link")).id=N.LINK_TAG_ID,n.onload=function(){return(0,O.sendWalkMeMessage)({type:A.BOT_SHOW})},n.type="text/css",n.rel="stylesheet",n.href=t,document.head&&document.head.append(n)):function(e){var t=document.getElementById(N.STYLE_TAG_ID);t||((t=document.createElement("style")).id=N.STYLE_TAG_ID,document.head&&document.head.append(t));var n=document.createTextNode(e);t.append(n),(0,O.sendWalkMeMessage)({type:A.BOT_SHOW})}(e):(0,O.sendWalkMeMessage)({type:A.BOT_SHOW})},t.splitStringByValue=function(e,t){var n=e.toLowerCase().indexOf(t.toLowerCase());if(!t||-1===n)return[e];var r=n+t.length;return[e.slice(0,n),e.slice(n,r),e.slice(r)]},t.delay=function(e){return new r(function(t){return setTimeout(t,e)})},t.getDelayCorrection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return e-((arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date).getTime()-t.getTime())},t.getDaysDiff=p,t.getOrdinal=v,t.getDateLabelFromToday=g,t.convertToPureText=h,t.mapRestoredDialogToMessages=function(e,t,n){var r=void 0,a=e.reduce(function(e,t){var r=t.textSettings?h(t.textSettings,n):t.text;return e.push(y({},t,{text:r})),e},[]).reduce(function(n,a,o){if(a.type===N.CONVERSATION_NODE_TYPES.action)return n;var i=0===o?void 0:e[o-1].id,s=new Date(a.createdAt);return r&&!p(r,s)||(n.push({text:g(s,t),isSeparator:!0}),r=s),Object.keys(a).includes("success")&&!a.success&&i?[].concat(l(n),[y({},a,{nodeId:i}),{text:a.errorMessage,type:N.CONVERSATION_NODE_TYPES.message,success:!1}]):!a.type&&i?[].concat(l(n),[y({},a,{nodeId:i})]):(n.push(a),n)},[]).map(function(e){var t=e.id,n=e.nodeId,r=e.text,a=e.success,o=e.isSeparator,i=e.createdAt,s=!e.type,u=Boolean(e.textSettings),c=i&&new Date(i).getTime();return s&&t&&n?{text:r,options:{isUserMessage:s,success:a,id:t,nodeId:n,timestamp:c}}:o?{text:r,options:{isSeparator:o}}:{text:r,options:{isRichMessage:u,isUserMessage:s,success:a,timestamp:c}}});return a.some(function(e){return e.options.isSeparator&&e.text===t.today})||a.push({text:t.today,options:{isSeparator:!0}}),a},t.getConversationDuration=function(e){return Math.round((Date.now()-e)/1e3)},t.hasBotChanged=function(e,t){return e.settings.botId!==t},t.mapSuggestions=function(e){return e.map(function(e,t){return k(e.displayValue)&&k(e.extractValue)?{id:D(String(e.displayValue))+"-"+t,displayName:e.displayValue,type:N.SUGGESTION_TYPES.text,extractValue:e.extractValue}:"object"!==(void 0===e?"undefined":S(e))?{id:D(String(e))+"-"+t,displayName:e,type:e.type||N.SUGGESTION_TYPES.text}:{}}).filter(function(e){return k(e.displayName)})},t.getSuggestionByName=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(function(t){return String(t.displayName).toLowerCase().trim()===e.toLowerCase().trim()})},t.getPreviousSibling=function(e,t){var n=e.previousElementSibling;if(!t)return n;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}};var m,E,b,T=c(n(26)),I=c(n(123)),w=c(n(389)),C=u(n(390)),A=u(n(25)),x=c(n(237)),N=n(27),O=n(54),M=t.safeDomElementRemove=function(e){"remove"in e&&"function"==typeof e.remove?e.remove():e.parentNode.removeChild(e)},k=t.isValidMessageValue=function(e){return e||!1===e||0===e},D=t.toHyphenCase=function(e){return e.toLowerCase().replace(/(['"`])/g,"").replace(/\s/g,"-")},B=(t.noop=function(){},t.stripHTMLTags=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return(0,T.default)(t,["body","textContent"],"")},t.getWMSearchResult=(m=d(i.mark(function e(t){return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,O.sendWalkMeMessage)({type:A.WALKME_SEARCH,payload:{searchTerm:t}});case 3:return e.abrupt("return",e.sent.map(function(e){return y({},e,{displayName:e.name})}));case 7:e.prev=7,e.t0=e.catch(0);case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}},e,void 0,[[0,7]])})),function(){return m.apply(this,arguments)}));t.resolveBBCodes=(E=d(i.mark(function e(t){return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,O.sendWalkMeMessage)({type:A.RESOLVE_BBCODES,payload:{text:t}});case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0);case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}},e,void 0,[[0,6]])})),function(){return E.apply(this,arguments)}),t.getInitialWMSearchResult=(b=d(i.mark(function e(){var t,n,a,o,u;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=B(""),n=B(" "),e.next=4,r.all([t,n]);case 4:return o=[].concat(l((a=e.sent)[0]),l(a[1])),u=o.reduce(function(e,t){return y({},e,f({},t.id,t))},{}),e.abrupt("return",s(u));case 8:case"end":return e.stop()}},e,void 0)})),function(){return b.apply(this,arguments)}),t.suggestionsSorter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments[2];return String(arguments[1].displayName).localeCompare(String(t.displayName))*e},t.nodeHasSuggestions=function(e){var t=e.suggestions,n=e.staticSuggestions;return Boolean(t&&t.length||n&&n.length)}}).call(this,n(7).assign,n(18).Promise,n(31).from,n(7).entries,n(33),n(7).values)},387:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(150),o=r(n(388)),i=r(n(480)),s=r(n(481)),u=r(n(482)),c=r(n(483)),d=r(n(484)),l=r(n(485));t.default=(0,a.combineReducers)({messages:o.default,settings:i.default,conversation:s.default,suggestions:u.default,dialog:c.default,loader:d.default,analytics:l.default})},388:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s,u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(248),d=(s=c)&&s.__esModule?s:{default:s},l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),f=n(32),p=t.initialState=[];t.default=(0,f.createReducer)(p,(a(i={},l.GET_BOT_DATA_SUCCESS,function(e,t){var n=t.settings;return t.addInitialMessageToChat?[].concat(o(e),[{text:(0,d.default)(n.initialMessages),options:{isUserMessage:!1,timestamp:Date.now()}}]):e}),a(i,l.ADD_MESSAGE,function(e,t){var n=t.message;return[].concat(o(e),[n])}),a(i,l.ADD_IDS_TO_LAST_MESSAGE,function(e,t){var n=t.id,r=t.nodeId;return e.map(function(t,a){return a===e.length-1?u({},t,{options:u({},t.options,{id:n,nodeId:r})}):t})}),a(i,l.REMOVE_ANSWER_SUCCESS,function(e,t){var n=t.id,r=t.nodeId,a=e.findIndex(function(e){var t=e.options;return t.id===n&&t.nodeId===r});return e.slice(0,a-1)}),a(i,l.FINISH_CONVERSATION,function(e){return e.map(function(e){return u({},e,{options:{isUserMessage:e.options.isUserMessage,isSeparator:e.options.isSeparator,success:e.options.success,isRichMessage:e.options.isRichMessage,timestamp:e.options.timestamp}})})}),a(i,l.ADD_SEPARATOR,function(e,t){var n=t.separator;return[].concat(o(t.isNewSeparator?e.filter(function(e){return e.text!==n}):e),[{options:{isSeparator:!0},text:n}])}),a(i,l.RESTORE_DIALOG_SUCCESS,function(e,t){return[].concat(o((0,f.mapRestoredDialogToMessages)(t.messages,t.defaultLabels,t.mentionData)))}),a(i,l.ADD_BOT_SETTINGS,function(){return p}),a(i,l.FLUSH_STORE,function(){return p}),i))}).call(this,n(7).assign,n(31).from)},480:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o,i=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(26),u=(o=s)&&o.__esModule?o:{default:o},c=n(32),d=n(27),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),f=t.initialState={apiBaseUrl:null,walkmeEndUserId:null,jwt:null,uuid:null,botId:null,conversationId:null,name:"",botCustomStyles:[],botActiveCustomStyle:null,initialMessages:[],noMatchedConversationErrorMessages:[],conversations:[],conversationsNodesMap:{},allConversations:[],suggestedConversations:[],fallbackConversations:[],calculateScroll:0,buttonSendText:null,buttonStartOverText:null,conversationUnpublishedText:null,conversationUpdatedText:null,doneText:null,noConversationsOneSearchItemFoundText:null,severalConversationsFoundText:null,suggestionsText:null,chatInputPlaceholderText:null,disabledInputText:null,separatorNewText:null,separatorTodayText:null,separatorYesterdayText:null,separatorCompletedText:null,isSuggestedConversationsOnly:!1,forceUpdate:!1,additionalSettings:{playMode:!1,previewEntityType:null},singleConversationPlayed:!1,liveChat:{enabledGlobal:!1,enabled:!1,suggestionText:null,failsBeforeTrigger:null,alwaysShowButton:!1,temporaryDisabled:!1,buttonLiveChatText:""},siteConfig:null,globalConfig:null,visibility:!0,failsBeforeFallbackSuggested:null};t.default=(0,c.createReducer)(f,(r(a={},l.TRY_INIT_SESSION,function(e,t){return i({},e,{userGuid:t.userGuid,walkmeEndUserId:t.walkmeEndUserId})}),r(a,l.ADD_BOT_SETTINGS,function(e,t){return i({},e,{botId:t.botId,conversationId:t.conversationId,additionalSettings:t.additionalSettings||f.additionalSettings,forceUpdate:t.forceUpdate,botCustomStyles:[],botActiveCustomStyle:null})}),r(a,l.GET_BOT_DATA_FAIL,function(e){return i({},e,{botId:null})}),r(a,l.GET_BOT_CONVERSATIONS_FAIL,function(e){return i({},e,{botId:null})}),r(a,l.INIT_SESSION_SUCCESS,function(e,t){return i({},e,{jwt:t.jwt,uuid:t.uuid,siteConfig:t.siteConfig,globalConfig:t.globalConfig})}),r(a,l.GET_BOT_DATA_SUCCESS,function(e,t){var n=t.settings,r=n.name,a=n.initialMessages,o=n.noMatchedConversationErrorMessages,s=n.suggestedConversations,c=n.fallbackConversations,l=n.buttonSendText,f=n.buttonStartOverText,p=n.buttonLiveChatText,v=n.conversationUnpublishedText,g=n.conversationUpdatedText,h=n.doneText,S=n.noConversationsOneSearchItemFoundText,y=n.severalConversationsFoundText,_=n.suggestionsText,m=n.chatInputPlaceholderText,E=n.disabledInputText,b=n.separatorNewText,T=n.separatorTodayText,I=n.separatorYesterdayText,w=n.separatorCompletedText,C=n.isSuggestedConversationsOnly,A=n.liveChatSuggestionText,x=n.liveChatEnabled,N=n.failsBeforeLiveChatTriggered,O=n.alwaysShowLiveChatButton,M=n.failsBeforeFallbackSuggested,k=n.isWalkMeSearchEnabled,D=n.isWalkMeSearchItemsSuggestedInitially,B=n.botCustomStyles;return B||(B=[{botId:e.botId,active:!0,botDesignId:1,css:(0,u.default)(n,"styles","")}]),i({},e,{forceUpdate:!1,name:r,botCustomStyles:B,botActiveCustomStyle:(B||[]).find(function(e){return e.active})||d.DEFAULT_THEME,initialMessages:a,noMatchedConversationErrorMessages:o,suggestedConversations:s,fallbackConversations:c,buttonSendText:l,buttonStartOverText:f,conversationUnpublishedText:v,conversationUpdatedText:g,doneText:h,noConversationsOneSearchItemFoundText:S,severalConversationsFoundText:y,suggestionsText:_,chatInputPlaceholderText:m,disabledInputText:E,separatorNewText:b,separatorTodayText:T,separatorYesterdayText:I,separatorCompletedText:w,isSuggestedConversationsOnly:C,liveChat:{enabledGlobal:(0,u.default)(e,["siteConfig","Settings","liveChat","isEnabled"],!1),enabled:x,temporaryDisabled:!1,suggestionText:A,failsBeforeTrigger:N,alwaysShowButton:O,buttonLiveChatText:p},failsBeforeFallbackSuggested:M,isWalkMeSearchEnabled:k,isWalkMeSearchItemsSuggestedInitially:D})}),r(a,l.GET_BOT_CONVERSATIONS_SUCCESS,function(e,t){var n=t.conversations;return i({},e,{conversations:n,conversationsNodesMap:n?n.reduce(function(e,t){return i({},e,r({},t.id,i({},t,{nodesMap:t.nodes.reduce(function(e,t){return i({},e,r({},t.id,t))},{})})))},{}):{}})}),r(a,l.GET_BOT_ALL_CONVERSATIONS_SUCCESS,function(e,t){return i({},e,{allConversations:t.allConversations})}),r(a,l.RECALCULATE_SCROLL,function(e){return i({},e,{calculateScroll:e.calculateScroll+1})}),r(a,l.PASS_ENV_ID,function(e,t){return i({},e,{envId:t.envId})}),r(a,l.PASS_API_BASE_URL,function(e,t){return i({},e,{apiBaseUrl:t.apiBaseUrl})}),r(a,l.CREATE_DIALOG_SUCCESS,function(e){return i({},e,{singleConversationPlayed:!0})}),r(a,l.FLUSH_STORE,function(e,t){var n=(0,u.default)(t,"isChatNeedDestroy",!1);return i({},e,{singleConversationPlayed:n})}),r(a,l.DISABLE_LIVE_CHAT,function(e){return i({},e,{liveChat:i({},e.liveChat,{temporaryDisabled:!0})})}),r(a,l.BOT_VISIBILITY,function(e,t){return i({},e,{visibility:t.visibility})}),a))}).call(this,n(7).assign)},481:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(32),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),u=t.initialState={picked:null,currentNode:null,byKeyword:null,conversationStarted:Date.now(),conversationLength:0};t.default=(0,i.createReducer)(u,(r(a={},s.CHOOSE_CONVERSATION_SUCCESS,function(e,t){return o({},e,{picked:t.conversation,byKeyword:t.byKeyword,conversationStarted:Date.now()})}),r(a,s.GET_CONVERSATION_NODE_SUCCESS,function(e,t){return o({},e,{currentNode:t.node,conversationLength:t.incrementCounter?e.conversationLength+1:e.conversationLength})}),r(a,s.FINISH_CONVERSATION,function(){return u}),r(a,s.ADD_BOT_SETTINGS,function(){return u}),r(a,s.FLUSH_STORE,function(){return u}),a))}).call(this,n(7).assign)},482:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(32),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),d=t.initialState={items:[],suggestionItems:[],wmSearchItems:[],loading:!1};t.default=(0,u.createReducer)(d,(a(i={},c.GET_SUGGESTIONS_SUCCESS,function(e,t){var n=t.suggestions;return s({},e,{items:[].concat(o(n),o(e.wmSearchItems)),suggestionItems:n,loading:!1})}),a(i,c.GET_WM_SEARCH_SUGGESTIONS_START,function(e){return s({},e,{loading:!0,wmSearchItems:[]})}),a(i,c.GET_WM_SEARCH_SUGGESTIONS_SUCCESS,function(e,t){var n=t.wmSearchItems;return s({},e,{items:[].concat(o(e.suggestionItems),o(n)),wmSearchItems:n,loading:!1})}),a(i,c.GET_REST_SUGGESTIONS_START,function(e){return s({},e,{loading:!0})}),a(i,c.CHOOSE_CONVERSATION_SUCCESS,function(){return d}),a(i,c.ADD_BOT_SETTINGS,function(){return d}),a(i,c.FLUSH_STORE,function(){return d}),i))}).call(this,n(7).assign,n(31).from)},483:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(32),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),d=t.initialState=null;t.default=(0,u.createReducer)(d,(a(i={},c.CREATE_DIALOG_SUCCESS,function(e,t){return s({},t.dialog)}),a(i,c.DIALOG_DATA_ADDED,function(e,t){var n=t.data,r=Object.keys(n).map(function(e){var t=Number(e);return isNaN(t)?e:t});return e.dataKeysSequence&&e.dataKeysSequence.length&&(r=[].concat(o(e.dataKeysSequence.filter(function(e){return!n.hasOwnProperty(e)})),o(r))),s({},e,{dataKeysSequence:r,data:s({},e.data,n)})}),a(i,c.DIALOG_TRUNCATE_DATA_SEQUENCE,function(e,t){var n=e.data,r=void 0===n?{}:n,o=e.dataKeysSequence,i=void 0===o?[]:o,u=i.findIndex(function(e){return e===t.dataKey}),c=-1===u?i:i.slice(0,u);return s({},e,{dataKeysSequence:c,data:c.reduce(function(e,t){return r.hasOwnProperty(t)?s({},e,a({},t,r[t])):e},{})})}),a(i,c.FINISH_CURRENT_DIALOG_SUCCESS,function(){return d}),a(i,c.ADD_BOT_SETTINGS,function(){return d}),a(i,c.FLUSH_STORE,function(){return d}),i))}).call(this,n(7).assign,n(31).from)},484:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),s=n(32),u=t.initialState={isBotThinking:!1,isBotWaitForAnswer:!0};t.default=(0,s.createReducer)(u,(r(a={},i.BOT_STATUS,function(e,t){return o({},e,{isBotThinking:t.isBotThinking})}),r(a,i.CHANGE_INPUT_FOCUS,function(e,t){return o({},e,{isBotWaitForAnswer:t.isBotWaitForAnswer})}),r(a,i.FINISH_CONVERSATION,function(e){return o({},e,{isBotThinking:!1})}),r(a,i.ADD_BOT_SETTINGS,function(){return u}),r(a,i.FLUSH_STORE,function(){return u}),a))}).call(this,n(7).assign)},485:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),s=n(32),u=t.initialState={retriesConversationSearch:0,retriesAnswerQuestion:0,searchTerm:null};t.default=(0,s.createReducer)(u,(r(a={},i.ANALYTICS_CONVERSATION_SEARCH_TRY,function(e,t){return o({},e,{retriesConversationSearch:e.retriesConversationSearch+1,searchTerm:t.searchTerm})}),r(a,i.CHOOSE_CONVERSATION_SUCCESS,function(e){return o({},e,{retriesConversationSearch:0,searchTerm:null})}),r(a,i.ANALYTICS_ANSWER_QUESTION_TRY,function(e){return o({},e,{retriesAnswerQuestion:e.retriesAnswerQuestion+1})}),r(a,i.FINISH_CONVERSATION,function(e){return o({},e,{retriesAnswerQuestion:0})}),r(a,i.GET_CONVERSATION_NODE_SUCCESS,function(e){return o({},e,{retriesAnswerQuestion:0})}),r(a,i.ADD_BOT_SETTINGS,function(){return u}),r(a,i.FLUSH_STORE,function(){return u}),a))}).call(this,n(7).assign)},486:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){var n,s=this,u=null,c=!1;t.subscribe((n=r.mark(function e(){var n,o,i,d;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getState(),i=(o=n.settings).botId,d=o.forceUpdate,!o.jwt||!i){e.next=8;break}if(u!==i&&(u=i,t.dispatch((0,a.loadBotData)(i,!0))),!d||c){e.next=8;break}return c=!0,e.next=7,t.dispatch((0,a.loadBotData)(i,!0));case 7:c=!1;case 8:u=i;case 9:case"end":return e.stop()}},e,s)}),function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})}));var d=t.subscribe(function(){var e=t.getState(),n=e.messages,r=e.dialog,a=e.settings,s=a.botId,u=a.name;r&&r.isRestored&&d(),n&&n.length&&n.some(function(e){return e.options.isUserMessage})&&((0,i.sendAnalyticsEvent)(o.ANALYTICS_EVENTS.endUserEngaged,{type:"actionBotBot",oId:s,oName:u}),d())})};var a=n(116),o=n(27),i=n(54)}).call(this,n(18).Promise,n(33))},487:function(e,t,n){"use strict";(function(e,r,a){function o(e,t){return Number(e&&e.initialSize&&e.initialSize[t])||l}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.changeHeaderHeight=function(e){var t=window.parent.document.querySelector("."+p.dragHeader.className);t&&(t.style.height=e+"px")};var s,u=n(488),c=(s=u)&&s.__esModule?s:{default:s},d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),l=320,f={topEdge:{className:"wm-top-edge",styles:{zIndex:10,width:"100%",height:"4px",position:"absolute",top:0,left:0,cursor:"ns-resize"}},bottomEdge:{className:"wm-bottom-edge",styles:{zIndex:10,width:"100%",height:"4px",position:"absolute",bottom:0,left:0,cursor:"ns-resize"}},rightEdge:{className:"wm-right-edge",styles:{zIndex:10,width:"4px",height:"100%",position:"absolute",top:0,right:0,cursor:"ew-resize"}},leftEdge:{className:"wm-left-edge",styles:{zIndex:10,width:"4px",height:"100%",position:"absolute",top:0,left:0,cursor:"ew-resize"}},rightTopEdge:{className:"wm-right-top-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",top:"2px",right:"2px",cursor:"nesw-resize"}},leftTopEdge:{className:"wm-left-top-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",top:"2px",left:"2px",cursor:"nwse-resize"}},rightBottomEdge:{className:"wm-right-bottom-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",bottom:"2px",right:"2px",cursor:"nwse-resize"}},leftBottomEdge:{className:"wm-left-bottom-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",bottom:"2px",left:"2px",cursor:"nesw-resize"}}},p={dragHeader:{className:"wm-drag-header",styles:{position:"absolute",top:0,left:0,height:"57px",width:"85%",zIndex:9}}};t.default=function t(n,s){var u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialize=function(){if(u.isMobileBrowser)u._node.style.width="100%",u._node.style.height="100%";else{var e=!0;u.globalConfig&&!1===u.globalConfig.resizable&&(e=!1),u.applyInitialPosition(),e&&(u.findChildIframes(),u.createEdgeElements())}},this.applyInitialPosition=function(){var e=parseInt(document.defaultView.getComputedStyle(u._node).width,10),t=parseInt(document.defaultView.getComputedStyle(u._node).height,10),n=window.innerWidth/2-e/2,a=window.innerHeight/2-t/2;if(u.globalConfig&&u.globalConfig.initialPosition){var o=u.globalConfig.initialPosition,i=o.top,s=o.left;i&&(a=Number(i)),s&&(n=Number(s))}r(u._node.style,{margin:"inherit",top:a+"px",left:n+"px",bottom:"auto",right:"auto"})},this.createNodeElements=function(e,t){return a(e).map(function(e){var n=i(e,2),a=n[0],o=n[1],s=document.createElement("div");return s.className=o.className,s.dataset[t]=a,r(s.style,o.styles),s})},this.createEdgeElements=function(){var e=document.createDocumentFragment();u.createNodeElements(f,"edge").forEach(function(t){t.addEventListener("mousedown",u.mouseDownHandler),e.appendChild(t)}),u.createNodeElements(p,"drag").forEach(function(t){t.addEventListener("mousedown",u.dragHandler),t.addEventListener("dblclick",u.dblClickHandler),e.appendChild(t)}),u._node.appendChild(e)},this.mouseDownHandler=function(e){var t=e.target.dataset.edge,n="resize"+t[0].toUpperCase()+t.slice(1);"function"==typeof u[n]&&(u._mouseMoveHandlerNames.push(n),u.changeVisibilityChildIframes("none"),u._isFullScreen=!1,u._startX=e.clientX,u._startY=e.clientY,u._startWidth=parseInt(document.defaultView.getComputedStyle(u._node).width,10),u._startHeight=parseInt(document.defaultView.getComputedStyle(u._node).height,10),document.documentElement.addEventListener("mousemove",u[n]),document.documentElement.addEventListener("mouseup",u.stopResize))},this.dragHandler=function(e){u.changeVisibilityChildIframes("none");var t=parseInt(document.defaultView.getComputedStyle(u._node).left,10),n=parseInt(document.defaultView.getComputedStyle(u._node).top,10);u._windowWidth=window.innerWidth,u._windowHeight=window.innerHeight,u._startWidth=parseInt(document.defaultView.getComputedStyle(u._node).width,10),u._startHeight=parseInt(document.defaultView.getComputedStyle(u._node).height,10),u._leftPosition=e.clientX-t,u._topPosition=e.clientY-n,document.documentElement.addEventListener("mousemove",u.dragMove),document.documentElement.addEventListener("mouseup",u.stopDrag)},this.dblClickHandler=function(){if(u._isFullScreen)r(u._node.style,u._prevScreenState),u._isFullScreen=!1;else{var e=u._node.style;u._prevScreenState={width:e.width,height:e.height,top:e.top,left:e.left},r(u._node.style,{width:"100%",height:"100%",top:0,left:0}),u._isFullScreen=!0}u._view.emitInside({type:d.RECALCULATE_SCROLL})},this.dragMove=function(e){var t=e.clientX-u._leftPosition,n=u._windowWidth-u._startWidth/2,r=0-u._startWidth/2,a=u.getAvailablePosition(e.clientY-u._topPosition,0,u._windowHeight-u._startHeight/2),o=u.getAvailablePosition(t,r,n);u._node.style.top=a+"px",u._node.style.left=o+"px"},this.getAvailablePosition=function(e,t,n){return e>t?e>t&&n>=e?e:n:t},this.resizeLeftEdge=function(e){var t=u._startWidth+u._startX-e.clientX;t>u.minWidth?(u._node.style.width=t+"px",u._node.style.left=e.clientX+"px"):u._node.style.width=u.minWidth+"px"},this.resizeRightEdge=function(e){var t=u._startWidth+e.clientX-u._startX;u._node.style.width=(t>u.minWidth?t:u.minWidth)+"px"},this.resizeTopEdge=function(e){var t=u._startHeight+u._startY-e.clientY;t>u.minHeight?(u._node.style.height=t+"px",u._node.style.top=e.clientY+"px"):u._node.style.height=u.minHeight+"px"},this.resizeBottomEdge=function(e){var t=u._startHeight+e.clientY-u._startY;u._node.style.height=(t>u.minHeight?t:u.minHeight)+"px"},this.resizeRightTopEdge=function(e){u.resizeRightEdge(e),u.resizeTopEdge(e)},this.resizeLeftTopEdge=function(e){u.resizeLeftEdge(e),u.resizeTopEdge(e)},this.resizeRightBottomEdge=function(e){u.resizeRightEdge(e),u.resizeBottomEdge(e)},this.resizeLeftBottomEdge=function(e){u.resizeLeftEdge(e),u.resizeBottomEdge(e)},this.findChildIframes=function(){u._iframes=[].concat(function(t){if(Array.isArray(t)){for(var n=0,r=Array(t.length);t.length>n;n++)r[n]=t[n];return r}return e(t)}(u._node.querySelectorAll("iframe")))},this.changeVisibilityChildIframes=function(e){var t=e;u._iframes.forEach(function(e){r(e.style,{pointerEvents:t})})},this.stopResize=function(){u.changeVisibilityChildIframes("auto"),u._mouseMoveHandlerNames.forEach(function(e){document.documentElement.removeEventListener("mousemove",u[e])})},this.stopDrag=function(){u.changeVisibilityChildIframes("auto"),document.documentElement.removeEventListener("mousemove",u.dragMove)},this._view=n,this._node=n._wmBotContainer,this.minWidth=o(s,"minWidth"),this.minHeight=o(s,"minHeight"),this.isMobileBrowser=c.default,this.globalConfig=s,this._mouseMoveHandlerNames=[],this._isFullScreen=!1,this._prevScreenState={},this.initialize()}}).call(this,n(31).from,n(7).assign,n(7).entries)},488:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)));t.default=r},54:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerConnection=function(){window.onWalkMeMessage=function(e){var t=e.type,n=e.payload;t===u.INIT_MESSAGE_FUNC&&"function"==typeof n.func?c=n.func:i.default.dispatch(t===u.TRY_INIT_SESSION?(0,s.initSession)(n.userGuid,n.walkmeEndUserId,n.uuid,n.siteConfig,n.globalConfig):e)}},t.sendWalkMeMessage=function(t){return new e(function(e,n){try{var a=t.payload;a?(a.hasOwnProperty("resolve"),a.hasOwnProperty("reject"),r(a,{resolve:e,reject:n})):r(t,{payload:{resolve:e,reject:n}}),c(t)}catch(e){n(e)}})},t.sendAnalyticsEvent=function(e,t){c({type:u.BOT_ANALYTICS_EVENT,payload:{type:e,data:t,options:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}}})};var a,o=n(198),i=(a=o)&&a.__esModule?a:{default:a},s=n(116),u=n(25),c=void 0}).call(this,n(18).Promise,n(7).assign)},61:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=o(n(366)),u=o(n(26)),c=o(n(198)),d=s.default.CancelToken,l=d.source();s.default.interceptors.request.use(function(t){var n=c.default.getState().settings,r=n.jwt,a=n.envId,o=n.apiBaseUrl;if(r&&Number.isFinite(a)){var s=i({},t.headers,{Authorization:"Bearer "+r,"x-wmab-wmenv":a,"x-wmab-utc-offset":(new Date).getTimezoneOffset(),Pragma:"no-cache"});e(t,{headers:s,cancelToken:l.token})}return o&&e(t,{url:o+t.url}),t},r.reject);var f,p,v=function(){l.cancel('Request was canceled by Cancel token. Reason: "'+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown reason")+'"')},g=(f=a.mark(function e(t,n,o,i){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.default.get("/bots/"+t+"/conversations/"+n+"/dialogs/"+o+"/nodes/"+i+"/suggestions").catch(function(e){var a=(0,u.default)(e,["response","status"]);return[500,504].includes(a)?g(t,n,o,i):r.reject(e)}));case 1:case"end":return e.stop()}},e,void 0)}),p=function(){var e=f.apply(this,arguments);return new r(function(t,n){return function a(o,i){try{var s=e[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});t(u)}("next")})},function(){return p.apply(this,arguments)});t.default={setNewCancelToken:function(){v("New token generated"),l=d.source()},cancelAllRequests:v,isCanceled:function(e){return s.default.isCancel(e)},fetchJWT:function(e){return s.default.post("/init",e)},fetchBotData:function(e){return s.default.get("/bots/"+e)},sendUserMessage:function(e){return s.default.post("/v1/bots/"+e.botId+"/conversations/"+e.conversationId+"/dialogs/"+e.dialogId+"/messages",{nodeId:e.nodeId,text:e.text})},postNode:function(e){return s.default.post("/bots/"+e.botId+"/conversations/"+e.conversationId+"/nodes/"+e.nodeId,{dialog:e.dialog})},postSalesforceMessage:function(e){return s.default.post("/bots/"+e.botId+"/conversations/"+e.conversationId+"/messages",{text:e.text,nodeId:e.nodeId,dialog:e.dialog})},getConversation:function(e,t){return s.default.get("/bots/"+e+"/conversations/"+t)},getConversations:function(e,t){return s.default.get("/bots/"+e+"/conversations",{params:{text:t}})},getFirstConversationNode:function(e,t,n){return s.default.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/nodes/first")},getNextConversationNode:function(e,t,n,r,a){return s.default.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/nodes/"+r,a?{params:a}:void 0)},createDialog:function(e,t){return s.default.post("/bots/"+e+"/conversations/"+t+"/dialogs")},getDialog:function(e,t,n){return s.default.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n)},restoreDialog:function(e,t){return s.default.get("/bots/"+e+"/dialogs/restore",{params:i({},t&&{conversationId:t})})},finishDialog:function(e,t,n){return s.default.put("/bots/"+e+"/conversations/"+t+"/dialogs/"+n,{isFinished:!0})},removeAnswer:function(e,t,n,r){return s.default.delete("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/messages/"+r)},getRestSuggestions:g}}).call(this,n(7).assign,n(18).Promise,n(33))},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(25),o=n(54),i=n(61),s=(r=i)&&r.__esModule?r:{default:r};t.default={error:function(e,t){s.default.isCanceled(e)||(0,o.sendWalkMeMessage)({type:a.SEND_ERROR_TO_LOGZ,payload:{error:e,clientRelated:t}})}}},760:function(e,t,n){"use strict";(function(e,r){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(777)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),u=a(n(487)),c=function(){function t(){var n,a,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.init=(n=r.mark(function e(t){var n,a=t.userGuid,c=t.walkmeEndUserId,d=t.envId,l=t.uuid,f=t.apiBaseUrl,p=t.publicPath,v=t.siteConfig,g=t.globalConfig;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o._view?o._view.update({userGuid:a,walkmeEndUserId:c,uuid:l,apiBaseUrl:f,publicPath:p,siteConfig:v,globalConfig:g}):(o._view=new i.default({userGuid:a,walkmeEndUserId:c,uuid:l,apiBaseUrl:f,publicPath:p,siteConfig:v,globalConfig:g}),o._bindViewEvents()),e.next=3,o._view.init();case 3:return n=e.sent,o._container=new u.default(o._view,g),o._view.emitInside({type:s.PASS_ENV_ID,payload:{envId:d}}),e.abrupt("return",n);case 7:case"end":return e.stop()}},e,o)}),a=function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})},function(){return a.apply(this,arguments)}),this.open=function(e){return o._view.open(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},this.show=function(){return o._view.show()},this.hide=function(){return o._view.hide()},this.emitInside=function(){var e;return(e=o._view).emitInside.apply(e,arguments)},this.close=function(){o._view&&o._view.destroy()},this.on=function(e,t){return o._view.on(e,t)},this.off=function(e,t){return o._view.removeListener(e,t)},this.emit=function(e){return o._view.emitInside(e)}}return o(t,[{key:"_bindViewEvents",value:function(){if(!this._view)throw new Error("Invalid view");this._view.on(s.BOT_HIDE,this.hide),this._view.on(s.BOT_SHOW,this.show)}}]),t}();t.default=c}).call(this,n(18).Promise,n(33))},777:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=o(n(778)),d=o(n(113)),l=o(n(134)),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),p=n(27),v=n(332),g=n(32),h={position:"fixed",width:"100%",height:"100%",top:0,left:0,pointerEvents:"none",zIndex:9999999999},S={position:"absolute",height:"550px",width:25*(window&&window.innerWidth||1)>400?"400px":"25%",minWidth:"320px",top:0,left:0,bottom:0,right:0,margin:"auto",borderRadius:"10px",boxShadow:"2px 2px 8px 0 rgba(0,0,0,0.5)",overflow:"hidden",userSelect:"none",pointerEvents:"auto"},y={width:"100%",height:"100%",border:"0",position:"absolute",top:"0",left:"0"},_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return m.call(n),n.createOrUpdatePrivates(t),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,c.default),u(e,[{key:"emitInside",value:function(e){this._iframe&&this._iframe.contentWindow&&this._iframe.contentWindow.onWalkMeMessage&&"function"==typeof this._iframe.contentWindow.onWalkMeMessage&&this._iframe.contentWindow.onWalkMeMessage(e)}},{key:"destroy",value:function(){(0,g.safeDomElementRemove)(this._wmBotWrapper),(0,g.safeDomElementRemove)(this._wmBotContainer),this._wmBotWrapper=null,this._wmBotContainer=null,this._iframe=null}}]),e}(),m=function(){var t,o=this;this.update=function(e){o.createOrUpdatePrivates(e)},this.createOrUpdatePrivates=function(e){var t=e.walkmeEndUserId,n=e.uuid,r=e.apiBaseUrl,a=e.publicPath,i=e.siteConfig,s=e.globalConfig;o._userGuid=e.userGuid,o._walkmeEndUserId=t,o._uuid=n,o._apiBaseUrl=o._getActionBotApiBaseUrl(r),o._publicPath=a,o._siteConfig=i,o._globalConfig=s},this.init=i(a.mark(function t(){var i,u,c,g,_,m;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Boolean(document.getElementById(p.IFRAME_ID))?o.tryInitSession():(o._wmBotWrapper=document.createElement("div"),o._wmBotWrapper.className=p.WM_WRAPPER_BOT_CLASSNAME+" "+p.WM_WRAPPER_BOT_CLASSNAME+"-latest",e(o._wmBotWrapper.style,h),o._wmBotContainer=document.createElement("div"),o._wmBotContainer.className=p.WM_BOT_CLASSNAME,i=s({},o._globalConfig&&o._globalConfig.initialSize&&s({},o._globalConfig.initialSize)),e(o._wmBotContainer.style,S,i),o._iframe=document.createElement("iframe"),o._iframe.id=p.IFRAME_ID,e(o._iframe.style,y),u=window,g=(c=u._walkmeExtension)&&c.nonceValue||"",_='\n      <head>\n          <link href="'+o._publicPath+"chat."+n.h+'.css" rel="stylesheet">\n      </head>\n      <body style="margin: 0">\n          <div id="root"></div>\n      </body>\n    ',o._wmBotContainer.appendChild(o._iframe),o._wmBotWrapper.appendChild(o._wmBotContainer),(m=d.default.deps.topContainerProvider.getTopContainer())&&m[0]?m[0].appendChild(o._wmBotWrapper):l.default.error(new Error("Can't find top container."),!0),o._iframe.contentWindow.document.write(_),o._iframe.contentWindow.publicPath=o._publicPath,o._iframe.onload=function(){var e=o._iframe.contentWindow.document.createElement("script");e.setAttribute("nonce",g),e.onload=function(){o.emitInside({type:f.INIT_MESSAGE_FUNC,payload:{func:function(e){if(e&&e.type)return o.emit(e.type,e.payload)}}}),o.emitInside({type:f.PASS_API_BASE_URL,payload:{apiBaseUrl:o._apiBaseUrl}}),o.tryInitSession()},e.src=o._publicPath+"chat."+n.h+".js",o._iframe.contentWindow.document.head.appendChild(e)},o._iframe.contentWindow.document.close(),o.hide()),t.abrupt("return",new r(function(e,t){o.on(f.INIT_SESSION_SUCCESS,function(t){(0,v.safeResolve)(t),e(t)}),o.on(f.INIT_SESSION_FAIL,function(e){(0,v.safeResolve)(e),t(e)})}));case 3:case"end":return t.stop()}},t,o)})),this.tryInitSession=function(){o.emitInside({type:f.TRY_INIT_SESSION,payload:{walkmeEndUserId:o._walkmeEndUserId,userGuid:o._userGuid,uuid:o._uuid,siteConfig:o._siteConfig,globalConfig:o._globalConfig}})},this.open=(t=i(a.mark(function e(t,n){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.emitInside({type:f.ADD_BOT_SETTINGS,payload:s({},t,{forceUpdate:n})}),e.abrupt("return",new r(function(e,t){o.on(f.BOT_SHOW,e),o.on(f.INITIAL_DATA_LOAD_FAIL,function(){return t(f.INITIAL_DATA_LOAD_FAIL)})}));case 2:case"end":return e.stop()}},e,o)})),function(){return t.apply(this,arguments)}),this.show=function(){o._wmBotWrapper.style.opacity=1,o._wmBotWrapper.style.zIndex=h.zIndex,o._wmBotContainer.style.boxShadow=S.boxShadow,o.emitInside({type:f.BOT_VISIBILITY,payload:{visibility:!0}})},this.hide=function(){o._wmBotWrapper.style.opacity=0,o._wmBotWrapper.style.zIndex="-1",o._wmBotContainer.style.boxShadow="none",o.emitInside({type:f.BOT_VISIBILITY,payload:{visibility:!1}})},this._getActionBotApiBaseUrl=function(e){return e+"/chatbot"}};t.default=_}).call(this,n(7).assign,n(18).Promise,n(33))},92:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.closeChatWindow=t.changeFocusInput=t.changeBotStatus=void 0;var r,a=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(54),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),s=n(27),u=n(61),c=(r=u)&&r.__esModule?r:{default:r};t.changeBotStatus=function(e){return{type:i.BOT_STATUS,payload:{isBotThinking:e}}},t.changeFocusInput=function(e){return{type:i.CHANGE_INPUT_FOCUS,payload:{isBotWaitForAnswer:e}}},t.closeChatWindow=function(){return function(e,t){var n=t();(0,o.sendWalkMeMessage)({type:i.BOT_CLOSE});var r=n.settings,u={type:"actionBotBot",oId:r.botId,oName:r.name};if(n.dialog&&n.dialog.id&&n.conversation.currentNode&&!r.additionalSettings.playMode){var d=n.conversation.currentNode;(0,o.sendAnalyticsEvent)(s.ANALYTICS_EVENTS.chatClosed,a({},u,{pId:n.dialog.id,aAppType:d.type,aoId:d.id,aoName:d.name}))}else(0,o.sendAnalyticsEvent)(s.ANALYTICS_EVENTS.chatClosed,u);e({type:i.FLUSH_STORE}),c.default.cancelAllRequests("Chat window closed")}}}).call(this,n(7).assign)},93:function(e,t,n){"use strict";(function(e,r,a,o){function i(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateWMSearchSuggestions=t.updateWMSearchSuggestionsSuccess=t.getRestSuggestions=t.getNextSuggestions=t.clearSuggestions=t.restoreCurrentNodeSuggestions=t.setInitialSuggestions=t.getSuggestionsSuccess=t.handleStaticSuggestions=void 0;var u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=i(n(26)),d=i(n(61)),l=i(n(63)),f=n(32),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25)),v=n(27),g=t.handleStaticSuggestions=function(e){var t=(0,c.default)(e,["settings","mergeType"],""),n=(0,c.default)(e,["settings","separatorText"],""),r=(0,c.default)(e,["settings","sortRecordsBy","type"])?1:-1,a=new Set(e.suggestions),o=f.suggestionsSorter.bind(void 0,r),i=(0,f.mapSuggestions)(e.staticSuggestions).filter(function(e){return!a.has(e.displayName)}).sort(o),s={id:v.SUGGESTIONS_SEPARATOR_ID,displayName:n,type:v.SUGGESTION_TYPES.separator},u=(0,f.mapSuggestions)(e.suggestions),d=n&&i.length&&u.length?[s]:[];switch(t){case v.SUGGESTION_MERGE_TYPES.top:return i.concat(d,u);case v.SUGGESTION_MERGE_TYPES.bottom:return u.concat(d,i);case v.SUGGESTION_MERGE_TYPES.merged:return u.concat(i).sort(o);default:return l.default.error(new Error("Unknown static suggestion merge type: "+t)),u}},h=t.getSuggestionsSuccess=function(e){return{type:p.GET_SUGGESTIONS_SUCCESS,payload:{suggestions:e}}},S=(t.setInitialSuggestions=function(e,t){return function(n,r){var o=r().settings,i=t||o.conversations,s=(e||o.suggestedConversations).reduce(function(e,t){var n=i.find(function(e){return e.id===t});return n?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}(e),[u({},n,{type:v.SUGGESTION_TYPES.conversation})]):e},[]);n(h(s))}},t.restoreCurrentNodeSuggestions=function(){return function(e,t){var n=t().conversation.currentNode;n&&e(h(n.staticSuggestions?g(n):(0,f.mapSuggestions)(n.suggestions)))}},t.clearSuggestions=function(){return function(e){return e(h([]))}},t.getNextSuggestions=function(e,t){var n=(0,f.mapSuggestions)(t);return(0,c.default)(e,"staticSuggestions",[]).length?g(e):n}),y=(t.getRestSuggestions=function(e){return t=s(o.mark(function t(n,r){var a,i,s,u,v,g,y;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),i=a.dialog,t.prev=1,n({type:p.GET_REST_SUGGESTIONS_START}),t.next=5,d.default.getRestSuggestions(i.botId,i.conversationId,i.id,e);case 5:if(s=t.sent.data,u=r(),v=(0,c.default)(u,["conversation","currentNode"]),g=(0,c.default)(v,"id"),!(0,f.hasBotChanged)(u,i.botId)&&e===g){t.next=12;break}return t.abrupt("return");case 12:y=S(v,s),n(h(y)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),l.default.error(t.t0);case 19:case"end":return t.stop()}},t,void 0,[[1,16]])})),function(){return t.apply(this,arguments)};var t},t.updateWMSearchSuggestionsSuccess=function(e){return{type:p.GET_WM_SEARCH_SUGGESTIONS_SUCCESS,payload:{wmSearchItems:e}}});t.updateWMSearchSuggestions=function(e){return t=s(o.mark(function t(n){var r;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:p.GET_WM_SEARCH_SUGGESTIONS_START}),r=[],e){t.next=8;break}return t.next=5,(0,f.getInitialWMSearchResult)();case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,(0,f.getWMSearchResult)(e);case 10:r=t.sent;case 11:return t.abrupt("return",n(y(r)));case 12:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}}).call(this,n(7).assign,n(18).Promise,n(31).from,n(33))}}]);